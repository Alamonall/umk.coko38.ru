(function(e){function t(t){for(var c,r,s=t[0],i=t[1],l=t[2],m=0,d=[];m<s.length;m++)r=s[m],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&d.push(o[r][0]),o[r]=0;for(c in i)Object.prototype.hasOwnProperty.call(i,c)&&(e[c]=i[c]);u&&u(t);while(d.length)d.shift()();return n.push.apply(n,l||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],c=!0,s=1;s<a.length;s++){var i=a[s];0!==o[i]&&(c=!1)}c&&(n.splice(t--,1),e=r(r.s=a[0]))}return e}var c={},o={app:0},n=[];function r(t){if(c[t])return c[t].exports;var a=c[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=c,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)r.d(a,c,function(t){return e[t]}.bind(null,c));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=i;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"2f92":function(e,t,a){"use strict";a("673d")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var c=a("2b0e"),o=a("31bd"),n=a("2f62"),r=a("5935");c["a"].use(n["a"]);var s=new n["a"].Store({strict:!0,state:{user:null,token:null,isSignin:!1,activeSidebar:null,publishers:[],subjects:[],areas:[],levels:[],emcs:[],emcsOnSchool:[],activeRouteParams:{subjectId:null,areaId:null,schoolId:null}},mutations:{updateField:r["c"]},getters:{getField:r["a"]}}),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("PageHeader"),"admin"===e.activeSidebar&&1===e.user.UserRole.code&&e.isSignin?a("TheAdminSidebar"):e._e(),"pmo"===e.activeSidebar&&2===e.user.UserRole.code&&e.isSignin?a("ThePmoSidebar"):e._e(),"poo"===e.activeSidebar&&3===e.user.UserRole.code&&e.isSignin?a("ThePooSidebar"):e._e(),"subjects"===e.activeSidebar&&e.isSignin?a("TheSubjectsSidebar"):e._e(),a("v-main",{attrs:{fixed:""}},[a("router-view")],1)],1)},l=[],u=a("5530"),m=(a("b0c0"),a("caad"),a("2532"),a("2ef0")),d=a.n(m),v=function(){var e=this,t=e.$createElement,c=e._self._c||t;return c("v-app-bar",{attrs:{app:"","clipped-left":""}},[c("div",{staticClass:"d-flex align-center"},[c("v-img",{staticClass:"shrink mr-2",attrs:{alt:"AIS EMC Logo",contain:"",src:a("cf05"),transition:"scale-transition",width:"40"}})],1),e.isSignin?e._e():c("v-btn",{attrs:{plain:""},on:{click:function(t){return e.goTo({name:"/"})}}},[e._v(" Система учёта УМК ")]),e.isSignin?c("div",[c("v-btn",{attrs:{plain:"",to:{path:"/"+e.user.UserRole.name}}},[e._v(" Система учёта УМК ")]),1==e.user.UserRole.code?c("v-btn",{attrs:{plain:""},on:{click:function(t){return e.goTo({name:"admin-emc-on-school"})}}},[e._v(" УМК ")]):e._e(),1==e.user.UserRole.code?c("v-btn",{attrs:{plain:""},on:{click:function(t){return e.goTo({name:"admin-emc"})}}},[e._v(" Конструктор ")]):e._e(),2==e.user.UserRole.code?c("v-btn",{attrs:{plain:""},on:{click:function(t){return e.goTo({name:"pmo-emc-on-school"})}}},[e._v(" УМК ")]):e._e(),2==e.user.UserRole.code?c("v-btn",{attrs:{plain:""},on:{click:function(t){return e.goTo({name:"pmo-emc"})}}},[e._v(" Конструктор ")]):e._e(),3==e.user.UserRole.code?c("v-btn",{attrs:{plain:""},on:{click:function(t){return e.goTo({name:"poo-emc-on-school"})}}},[e._v(" УМК ")]):e._e(),3==e.user.UserRole.code?c("v-btn",{attrs:{plain:""},on:{click:function(t){return e.goTo({name:"poo-emc"})}}},[e._v(" Конструктор ")]):e._e()],1):e._e(),c("v-spacer"),e.isSignin?c("v-btn",{attrs:{plain:"",to:{path:"/"+e.user.UserRole.name}}},[e._v(" "+e._s(e.user.username))]):e._e(),e.isSignin?c("v-btn",{attrs:{plain:""},on:{click:e.signout}},[e._v(" Выход ")]):e._e(),e.isSignin?e._e():c("v-btn",{attrs:{plain:""},on:{click:function(t){return e.goTo({name:"/"})}}},[e._v(" Войти ")])],1)},h=[],p={computed:Object(u["a"])({},Object(r["b"])(["isSignin","user","token","activeSidebar","activeRouteParams"])),methods:{signout:function(){this.token=null,this.user=null,this.activeSidebar=null,this.isSignin=!1,this.goTo({name:"/",params:null})},goTo:function(e){var t=e.name,a=e.params;console.log({msg:"goTo",name:t,params:a}),this.activeRouteParams=a,this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)}))}}},b=p,g=a("2877"),f=a("6544"),_=a.n(f),O=a("40dc"),x=a("8336"),S=a("adda"),C=a("2fa4"),j=Object(g["a"])(b,v,h,!1,null,null,null),E=j.exports;_()(j,{VAppBar:O["a"],VBtn:x["a"],VImg:S["a"],VSpacer:C["a"]});var w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-navigation-drawer",{attrs:{app:"",width:"25%",left:"true",height:"100%",permanent:"",absolute:"",clipped:""}},e._l(e.areas,(function(t){return a("v-list-group",{key:t.AreaID,attrs:{value:!1,"prepend-icon":"mdi-account-circle"},scopedSlots:e._u([{key:"activator",fn:function(){return[a("v-list-item-title",[e._v(e._s(t.name))])]},proxy:!0}],null,!0)},e._l(t.Schools,(function(c){return a("v-list-group",{key:c.id,attrs:{value:!1,"no-action":"","sub-group":""},scopedSlots:e._u([{key:"activator",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",{attrs:{blue:""}},[e._v(e._s(c.code)+" "+e._s(c.name)+" ")])],1)]},proxy:!0}],null,!0)},e._l(e.subjects,(function(o){return a("v-list-item",{key:o.id,attrs:{value:!1,link:""}},[a("v-list-item-content",[a("v-btn",{attrs:{plain:""},on:{click:function(a){return e.goTo({name:"admin-emc-on-school",params:{areaId:t.id,subjectId:o.id,schoolId:c.id}})}}},[e._v(" "+e._s(o.name)+" ")])],1)],1)})),1)})),1)})),1)},k=[],R={name:"TheAdminSidebar",data:function(){return{err:null}},computed:Object(u["a"])({},Object(r["b"])(["subjects","activeRouteParams","areas"])),methods:{goTo:function(e){var t=e.name,a=e.params;console.debug({msg:"goTo",name:t,params:a}),d.a.isEqual(this.activeRouteParams,a)||(this.activeRouteParams=a,this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})))}}},P=R,V=a("56b0"),I=a("da13"),T=a("5d23"),D=a("f774"),z=Object(g["a"])(P,w,k,!1,null,"e7831a50",null),A=z.exports;_()(z,{VBtn:x["a"],VListGroup:V["a"],VListItem:I["a"],VListItemContent:T["a"],VListItemTitle:T["c"],VNavigationDrawer:D["a"]});var $=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-navigation-drawer",{attrs:{app:"",width:"25%",left:"true",height:"100%",permanent:"",absolute:"",clipped:""}},e._l(e.schools,(function(t){return a("v-list-group",{key:t.id,attrs:{value:!1,"prepend-icon":"mdi-account-circle"},scopedSlots:e._u([{key:"activator",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",{attrs:{blue:""}},[e._v(e._s(t.code)+" "+e._s(t.name)+" ")])],1)]},proxy:!0}],null,!0)},e._l(e.subjects,(function(c){return a("v-list-item",{key:c.id,attrs:{value:!1,link:""}},[a("v-list-item-content",[a("v-btn",{attrs:{plain:""},on:{click:function(a){return e.goTo({name:"pmo-emc-on-school",params:{subjectId:c.id,schoolId:t.id}})}}},[e._v(" "+e._s(c.name)+" ")])],1)],1)})),1)})),1)},y=[],F={name:"ThePmoSidebar",data:function(){return{err:null}},computed:Object(u["a"])({},Object(r["b"])(["subjects","schools","activeRouteParams"])),methods:{goTo:function(e){var t=e.name,a=e.params;console.debug({msg:"goTo",name:t,params:a}),d.a.isEqual(this.activeRouteParams,a)||(this.activeRouteParams=a,this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})))}}},L=F,M=Object(g["a"])(L,$,y,!1,null,"65369c0b",null),U=M.exports;_()(M,{VBtn:x["a"],VListGroup:V["a"],VListItem:I["a"],VListItemContent:T["a"],VListItemTitle:T["c"],VNavigationDrawer:D["a"]});var B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-navigation-drawer",{attrs:{app:"",width:"25%",left:"true",height:"100%",permanent:"",absolute:"",clipped:""}},[a("v-list",{attrs:{dense:""}},[a("v-subheader",[e._v("Предметы")]),e._l(e.subjects,(function(t){return a("v-list-item",{key:t.id},[a("v-list-item-content",[a("v-btn",{attrs:{plain:""},on:{click:function(a){return e.goTo({name:"poo-emc-on-school",params:{subjectId:t.id}})}}},[e._v(" "+e._s(t.name)+" ")])],1)],1)}))],2)],1)},N=[],q={name:"ThePooSidebar",data:function(){return{err:null}},computed:Object(u["a"])({},Object(r["b"])(["subjects","activeRouteParams"])),methods:{goTo:function(e){var t=e.name,a=e.params;console.debug({msg:"goTo",name:t,params:a}),d.a.isEqual(this.activeRouteParams,a)||(this.activeRouteParams=a,this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})))}}},G=q,H=a("8860"),J=a("e0c7"),K=Object(g["a"])(G,B,N,!1,null,"020d90d3",null),Q=K.exports;_()(K,{VBtn:x["a"],VList:H["a"],VListItem:I["a"],VListItemContent:T["a"],VNavigationDrawer:D["a"],VSubheader:J["a"]});var W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-navigation-drawer",{attrs:{app:"",width:"25%",left:"true",height:"100%",permanent:"",absolute:"",clipped:""}},e._l(e.subjects,(function(t){return a("v-list-item",{key:t.id,attrs:{value:!1,link:""}},[a("v-list-item-content",[1==e.user.UserRole.code?a("v-btn",{attrs:{plain:""},on:{click:function(a){return e.goTo({name:"admin-emc",params:{subjectId:t.id}})}}},[e._v(" "+e._s(t.name)+" ")]):e._e(),2==e.user.UserRole.code?a("v-btn",{attrs:{plain:""},on:{click:function(a){return e.goTo({name:"pmo-emc",params:{subjectId:t.id}})}}},[e._v(" "+e._s(t.name)+" ")]):e._e(),3==e.user.UserRole.code?a("v-btn",{attrs:{plain:""},on:{click:function(a){return e.goTo({name:"poo-emc",params:{subjectId:t.id}})}}},[e._v(" "+e._s(t.name)+" ")]):e._e()],1)],1)})),1)},X=[],Y={name:"TheSubjectsSidebar",data:function(){return{err:null}},computed:Object(u["a"])({},Object(r["b"])(["user","subjects","activeRouteParams"])),methods:{goTo:function(e){var t=e.name,a=e.params;console.debug({msg:"goTo",name:t,params:a}),d.a.isEqual(this.activeRouteParams,a)||(this.activeRouteParams=a,this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})))}}},Z=Y,ee=Object(g["a"])(Z,W,X,!1,null,"9cb36e70",null),te=ee.exports;_()(ee,{VBtn:x["a"],VListItem:I["a"],VListItemContent:T["a"],VNavigationDrawer:D["a"]});var ae={name:"App",components:{PageHeader:E,TheAdminSidebar:A,ThePmoSidebar:U,ThePooSidebar:Q,TheSubjectsSidebar:te},data:function(){return{err:null}},computed:Object(u["a"])({},Object(r["b"])(["isSignin","user","activeSidebar","subjects","areas","activeRouteParams"])),created:function(){document.title="АИС «УМК»"},methods:{goTo:function(e){var t=e.name,a=e.params;d.a.isEqual(this.activeRouteParams,a)||(this.activeRouteParams=a,this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})))}}},ce=ae,oe=a("7496"),ne=a("f6c4"),re=Object(g["a"])(ce,i,l,!1,null,null,null),se=re.exports;_()(re,{VApp:oe["a"],VMain:ne["a"]});var ie=a("8c4f"),le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-row",{staticClass:"d-flex justify-center"},[a("v-col",{staticClass:"mt-5",attrs:{cols:"12",sm:"3"}},[a("v-form",[a("v-text-field",{attrs:{type:"username",name:"username",autocomplete:"off",maxlength:"20"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),a("v-text-field",{attrs:{autocomplete:"off",type:"password",name:"input-10-1",label:"Normal with hint text",hint:"At least 8 characters"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("v-btn",{on:{click:e.signup}},[e._v(" Зарегистрироваться ")])],1)],1)],1)},ue=[],me=a("1da1"),de=(a("96cf"),a("bc3a")),ve=a.n(de),he=function(){return ve.a.create({headers:{Authorization:"Bearer ".concat(s.state.token)}})},pe={signup:function(e){return he().post("signup",e)},signin:function(e){return he().post("signin",e)}},be={data:function(){return{username:"Введите логин",password:"Пароль"}},methods:{signup:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pe.signup({username:e.username,password:e.password});case 2:case"end":return t.stop()}}),t)})))()}}},ge=be,fe=a("62ad"),_e=a("4bd4"),Oe=a("0fd9"),xe=a("8654"),Se=Object(g["a"])(ge,le,ue,!1,null,"1f71653f",null),Ce=Se.exports;_()(Se,{VBtn:x["a"],VCol:fe["a"],VForm:_e["a"],VRow:Oe["a"],VTextField:xe["a"]});var je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-row",{staticClass:"d-flex justify-center"},[a("v-col",{staticClass:"mt-5",attrs:{cols:"12",sm:"3"}},[a("v-form",[a("v-text-field",{attrs:{type:"username",name:"username",maxlength:"20",placeholder:"Введите логин",require:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),a("v-text-field",{attrs:{type:"password",name:"input-10-1",label:"Введите пароль",placeholder:"Введите пароль",hint:"Как минимум 8 символов",require:""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("v-btn",{on:{click:e.signin}},[e._v(" Войти ")])],1)],1)],1)},Ee=[],we={data:function(){return{username:"",password:"",error:null}},computed:Object(u["a"])({},Object(r["b"])(["token","user","isSignin"])),methods:{signin:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,pe.signin({username:e.username,password:e.password});case 3:a=t.sent,e.token=a.data.token,e.user=a.data.user,e.isSignin=!0,1===e.user.UserRole.code?e.$router.push("/admin").catch((function(e){return console.error(e)})):2===e.user.UserRole.code?e.$router.push("/pmo").catch((function(e){return console.error(e)})):3===e.user.UserRole.code&&e.$router.push("/poo").catch((function(e){return console.error(e)})),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.error=t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}}},ke=we,Re=Object(g["a"])(ke,je,Ee,!1,null,"e0effb88",null),Pe=Re.exports;_()(Re,{VBtn:x["a"],VCol:fe["a"],VForm:_e["a"],VRow:Oe["a"],VTextField:xe["a"]});var Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"text-center align-center"},[e._v("Страница не найдена")])},Ie=[],Te={},De=Te,ze=Object(g["a"])(De,Ve,Ie,!1,null,null,null),Ae=ze.exports,$e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&1==e.user.UserRole.code?a("v-row",[a("v-col",[e._v(" Admin ")])],1):e._e()},ye=[],Fe={getUserData:function(){return he().post("/admin")},getEmcOnSchool:function(e){var t=e.areaId,a=e.schoolId,c=e.subjectId,o=e.limit,n=e.skip;return he().post("/admin/list_emc_on_school",{areaId:t,schoolId:a,subjectId:c,limit:o,skip:n})},getEmc:function(e){var t=e.emcId,a=e.areaId,c=e.schoolId,o=e.subjectId,n=e.limit,r=e.skip;return he().post("/admin/list_emc",{emcId:t,areaId:a,schoolId:c,subjectId:o,limit:n,skip:r})},getEmcToAttach:function(e){var t=e.areaId,a=e.schoolId,c=e.subjectId,o=e.skip,n=e.limit;return he().post("/admin/list_emc_to_attach",{areaId:t,schoolId:a,subjectId:c,skip:o,limit:n})},updateEmc:function(e){var t=e.emc;return he().post("/admin/update_emc",{emc:t})},deleteEmc:function(e){var t=e.emcId;return he().post("/admin/delete_emc",{emcId:t})},updateEmcOnSchool:function(e){var t=e.emcOnSchoolId,a=e.usingCoz,c=e.correctionCoz,o=e.swapCoz,n=e.studentsCount,r=e.isApproved;return console.log({msg:"updateEmcOnSchool: ",emcOnSchoolId:t,usingCoz:a,correctionCoz:c,swapCoz:o,studentsCount:n,isApproved:r}),he().post("/admin/update_emc_on_school",{emcOnSchoolId:t,usingCoz:a,correctionCoz:c,swapCoz:o,studentsCount:n,isApproved:r})},createEmc:function(e){var t=e.emc;return he().post("/admin/create_emc",{title:t.title,authors:t.authors,grades:t.grades,publisherId:t.Publisher.id,subjectId:t.Subject.id,levelId:t.Level.id})},attachTo:function(e){var t=e.emcId,a=e.areaId,c=e.schoolId,o=e.swapCoz,n=e.usingCoz,r=e.correctionCoz,s=e.studentsCount;return console.log({swapCoz:o,usingCoz:n,correctionCoz:r,studentsCount:s}),he().post("/admin/attach_emc",{emcId:t,areaId:a,schoolId:c,swapCoz:o,usingCoz:n,correctionCoz:r,studentsCount:s})},detachFrom:function(e){var t=e.areaId,a=e.schoolId,c=e.emcOnSchoolId;return he().post("/admin/detach_emc",{areaId:t,schoolId:a,emcOnSchoolId:c})}},Le={computed:Object(u["a"])({},Object(r["b"])(["isSignin","user","activeSidebar","subjects","levels","areas","publishers"])),created:function(){this.init(),this.activeSidebar=null},methods:{init:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Fe.getUserData();case 3:a=t.sent,e.subjects=a.data.subjects,e.publishers=a.data.publishers,e.levels=a.data.levels,e.areas=a.data.areas,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.err=t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}}},Me=Le,Ue=Object(g["a"])(Me,$e,ye,!1,null,"23acc2b2",null),Be=Ue.exports;_()(Ue,{VCol:fe["a"],VRow:Oe["a"]});var Ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&1==e.user.UserRole.code?a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("h1",{staticClass:"text-center"},[e._v(e._s(e.subjectTitle))])])],1),a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"12"}},[e.activeRouteParams&&e.activeRouteParams.subjectId?a("EmcOnSchoolSelector"):e._e()],1),0===e.emcsOnSchool.length?a("v-card",{staticClass:"mx-auto text-center"},[e._v(" Отсутствуют УМК ")]):e._e(),a("v-col",{attrs:{cols:"12"}},e._l(e.emcsOnSchool,(function(t){return a("v-row",{key:t.id},[a("EmcOnSchoolCard",{attrs:{"emc-on-school":t},on:{onDetachEmcFrom:e.detachEmcFrom,onSwapApprovingStatusEmcOnSchool:e.swapApprovingStatusEmcOnSchool}})],1)})),1),e.emcsOnSchool.length>0?a("v-col",{attrs:{cols:"12"}},[a("v-pagination",{attrs:{length:e.totalPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1):e._e()],1)],1):e._e()},qe=[],Ge=(a("7db0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"px-0",attrs:{fluid:""}},[a("v-card",[a("v-card-title",{staticClass:"text-h4"},[e._v(" УМК: "+e._s(e.emcOnSchool.EMC.title)+" ")]),a("v-card-text",{staticClass:"text-h5"},[a("div",[a("v-chip",{directives:[{name:"show",rawName:"v-show",value:e.emcOnSchool.isApproved,expression:"emcOnSchool.isApproved"}],attrs:{color:"green","text-color":"white",pill:""}},[e._v(" Утверждено ")]),a("v-chip",{directives:[{name:"show",rawName:"v-show",value:!e.emcOnSchool.isApproved,expression:"!emcOnSchool.isApproved"}],attrs:{color:"yellow","text-color":"black",pill:""}},[e._v(" Не утверждено ")]),a("v-chip",{directives:[{name:"show",rawName:"v-show",value:e.emcOnSchool.EMC.isCustom,expression:"emcOnSchool.EMC.isCustom"}],attrs:{color:"red","text-color":"white",pill:""}},[e._v(" Пользовательский ")]),a("v-chip",{attrs:{color:"green","text-color":"white",pill:""}},[e._v(" "+e._s(e.emcOnSchool.School.schoolName)+" "+e._s(e.emcOnSchool.School.schoolCode)+" ")])],1),a("p",[a("strong",[e._v("Издательство:")]),e._v(" "+e._s(e.emcOnSchool.EMC.Publisher.publisherName))]),a("p",[a("strong",[e._v("Авторы:")]),e._v(" "+e._s(e.emcOnSchool.EMC.authors))]),a("p",[a("strong",[e._v("Класс:")]),e._v(" "+e._s(e.emcOnSchool.EMC.grades))]),a("p",[a("strong",[e._v("Кол-во учеников:")]),e._v(" "+e._s(e.emcOnSchool.studentsCount))]),a("p",[a("strong",[e._v("Уровень:")]),e._v(" "+e._s(e.emcOnSchool.EMC.Level?e.emcOnSchool.EMC.Level.name:"Нет данных")+" ")])]),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){e.isDetailing=!e.isDetailing}}},[e._v(" Комментарии ")]),a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.$emit("onSwapApprovingStatusEmcOnSchool",e.emcOnSchool)}}},[e._v(" "+e._s(e.emcOnSchool.isApproved?"Отменить утверждение":"Утвердить")+" ")]),a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.goTo({name:"admin-emc-edit",params:{emcId:e.emcOnSchool.emcId,from:"admin-emc-on-school"}})}}},[e._v(" Редактировать ")]),a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.$emit("onDetachEmcFrom",e.emcOnSchool)}}},[e._v(" Открепить УМК ")]),a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.$emit("onDetachEmcFrom",e.emcOnSchool)}}},[e._v(" Открепить УМК от всех МО и ОО ")])],1),a("v-expand-transition",[a("v-card",{directives:[{name:"show",rawName:"v-show",value:e.isDetailing,expression:"isDetailing"}]},[a("v-tabs",{attrs:{"background-color":"transparent",color:"basil",grow:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab",[e._v("Кол-во учеников")]),a("v-tab",[e._v("Причина использования")]),a("v-tab",[e._v("Причина изменения")]),a("v-tab",[e._v("Причина смены")])],1),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{additionalEOSTitle:"Кол-во учеников",additionalEOSDataValue:e.emcOnSchool.studentsCount,isNumber:!0},on:{onSaveAdditionalData:e.saveStudentsCount}}),e._v(" "+e._s(e.emcOnSchool.studentsCount))],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{additionalEOSTitle:"Причина использования",additionalEOSDataValue:e.emcOnSchool.usingCoz},on:{onSaveAdditionalData:e.saveUsingCozComment}}),e._v(" "+e._s(e.emcOnSchool.usingCoz)+" ")],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{additionalEOSTitle:"Причина изменения",additionalEOSDataValue:e.emcOnSchool.correctionCoz},on:{onSaveAdditionalData:e.saveCorrectionCozComment}}),e._v(" "+e._s(e.emcOnSchool.correctionCoz))],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{additionalEOSTitle:"Причина смены",additionalEOSDataValue:e.emcOnSchool.swapCoz},on:{onSaveAdditionalData:e.saveSwapCozComment}}),e._v(" "+e._s(e.emcOnSchool.swapCoz))],1)],1)],1)],1)],1)],1)],1)],1)}),He=[],Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{persistent:"","max-width":"640","min-width":"480"},scopedSlots:e._u([{key:"activator",fn:function(t){var c=t.on,o=t.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:"",plain:""}},"v-btn",o,!1),c),[a("v-icon",[e._v("mdi-border-color")])],1)]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"text-h5 text-center",domProps:{textContent:e._s(e.additionalEOSTitle)}}),a("v-card-text",[a("v-text-field",{attrs:{type:e.isNumber?"number":"text"},model:{value:e.localAdditionalEOSDataValue,callback:function(t){e.localAdditionalEOSDataValue=t},expression:"localAdditionalEOSDataValue"}})],1),a("v-card-actions",[a("v-btn",{attrs:{color:"red lighten-1",text:""},on:{click:function(t){e.dialog=!1,e.localAdditionalEOSDataValue=null}}},[e._v(" Отменить ")]),a("v-spacer"),a("v-btn",{attrs:{color:"teal accent-3",text:""},on:{click:function(t){e.dialog=!1,e.$emit("onSaveAdditionalData",e.localAdditionalEOSDataValue)}}},[e._v(" Сохранить ")])],1)],1)],1)},Ke=[],Qe={props:["additionalEOSTitle","additionalEOSDataValue","isNumber"],data:function(){return{dialog:!1,localAdditionalEOSDataValue:null}},created:function(){this.localAdditionalEOSDataValue=this.additionalEOSDataValue},watch:{localAdditionalEOSDataValue:function(e){this.localAdditionalEOSDataValue=e}}},We=Qe,Xe=a("b0af"),Ye=a("99d9"),Ze=a("169a"),et=a("132d"),tt=Object(g["a"])(We,Je,Ke,!1,null,null,null),at=tt.exports;_()(tt,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VDialog:Ze["a"],VIcon:et["a"],VSpacer:C["a"],VTextField:xe["a"]});var ct={components:{TheEditAdditionalEOSData:at},props:{emcOnSchool:{type:Object,default:null}},data:function(){return{error:null,tab:null,isDetailing:!1}},computed:Object(u["a"])({},Object(r["b"])(["activeRouteParams","isSignin","user","emcs","emcsOnSchool"])),methods:{saveUsingCozComment:function(e){this.updateEmcOnSchool({usingCoz:e})},saveCorrectionCozComment:function(e){this.updateEmcOnSchool({correctionCoz:e})},saveSwapCozComment:function(e){this.updateEmcOnSchool({swapCoz:e})},saveStudentsCount:function(e){this.updateEmcOnSchool({studentsCount:e})},updateEmcOnSchool:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Fe.updateEmcOnSchool(Object(u["a"])({emcOnSchoolId:t.emcOnSchool.id},e));case 3:t.activeRouteParams=Object(u["a"])({},t.activeRouteParams),a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),t.error=a.t0;case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()},goTo:function(e){var t=e.name,a=e.params;d.a.isEqual(this.activeRouteParams,a)||(this.activeRouteParams=Object(u["a"])(Object(u["a"])({},this.activeRouteParams),a),this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})))}}},ot=ct,nt=(a("61b5"),a("cc20")),rt=a("a523"),st=a("0789"),it=a("71a3"),lt=a("c671"),ut=a("fe57"),mt=a("aac8"),dt=Object(g["a"])(ot,Ge,He,!1,null,"2667b36a",null),vt=dt.exports;_()(dt,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VChip:nt["a"],VContainer:rt["a"],VExpandTransition:st["a"],VTab:it["a"],VTabItem:lt["a"],VTabs:ut["a"],VTabsItems:mt["a"]});var ht=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",{staticClass:"text-h5"},[e._v(" Добавить УМК ")]),a("v-card-text",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-autocomplete",{attrs:{items:e.emcsTitles,"no-data-text":"Нет данных","item-text":"Description","item-value":"emc",dense:"",solo:"","hide-selected":"",label:"УМК",placeholder:"Введите параметр УМК, по которому вы хотите найти нужный","prepend-icon":"mdi-database-search"},scopedSlots:e._u([{key:"item",fn:function(t){return[a("v-list-item-content",[a("v-list-item-title",[e._v(e._s(t.item.emc.previewData["Название"]))]),a("v-list-item-subtitle",[a("p",[e._v(" Авторы: "+e._s(t.item.emc.previewData["Авторы"])+"; Издатель: "+e._s(t.item.emc.previewData["Издатель"])+"; Классы: "+e._s(t.item.emc.previewData["Классы"])+" ")])])],1)]}}]),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1)],1),a("v-expand-transition",[e.model?a("v-list",[e._l(e.fields,(function(t,c){return a("v-list-item",{key:c},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:e._s(t.value)}}),a("v-list-item-subtitle",{domProps:{textContent:e._s(t.key)}})],1)],1)})),a("v-list-item",[a("v-text-field",{attrs:{type:"number",label:"Количество учеников"},model:{value:e.additionalDataForEmcOnSchool.studentsCount,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"studentsCount",t)},expression:"additionalDataForEmcOnSchool.studentsCount"}})],1),a("v-list-item",[a("v-text-field",{attrs:{label:"Причины использования"},model:{value:e.additionalDataForEmcOnSchool.usingCoz,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"usingCoz",t)},expression:"additionalDataForEmcOnSchool.usingCoz"}})],1),a("v-list-item",[a("v-text-field",{attrs:{label:"Причины смены"},model:{value:e.additionalDataForEmcOnSchool.swapCoz,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"swapCoz",t)},expression:"additionalDataForEmcOnSchool.swapCoz"}})],1),a("v-list-item",[a("v-text-field",{attrs:{label:"Планируемая корректировка"},model:{value:e.additionalDataForEmcOnSchool.correctionCoz,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"correctionCoz",t)},expression:"additionalDataForEmcOnSchool.correctionCoz"}})],1)],2):e._e()],1),a("v-card-actions",[a("v-btn",{attrs:{disabled:!e.model,color:"teal accent-3"},on:{click:e.attachEmc}},[e._v(" Добавить "),a("v-icon",{attrs:{right:""}},[e._v(" mdi-check ")])],1),a("v-spacer"),a("v-btn",{attrs:{disabled:!e.model,color:"red lighten-1"},on:{click:function(t){e.model=null}}},[e._v(" Закрыть "),a("v-icon",{attrs:{right:""}},[e._v(" mdi-close-circle ")])],1)],1)],1)},pt=[],bt=(a("d81d"),a("b64b"),a("4de4"),a("99af"),a("fb6a"),{data:function(){return{model:null,additionalDataForEmcOnSchool:{swapCoz:null,usingCoz:null,correctionCoz:null,studentsCount:0},descriptionLimit:200,error:null}},computed:Object(u["a"])(Object(u["a"])({},Object(r["b"])(["emcs","emcsOnSchool","user","activeRouteParams"])),{},{routeParams:function(){return this.activeRouteParams},fields:function(){var e=this;return this.model?Object.keys(this.model.previewData).map((function(t){return{key:e.model.previewData[t],value:t}})):[]},emcsTitles:function(){var e=this;return this.emcs.reduce((function(t,a){var c;if(a&&a.Subject.id===(null===(c=e.activeRouteParams)||void 0===c?void 0:c.subjectId)&&0===e.emcsOnSchool.filter((function(t){return t.emcId===a.id&&t.School.id===e.activeRouteParams.schoolId})).length){var o=null==a.title?"Нет имени":a.title,n=null==a.authors?"Нет авторов":a.authors,r=o.concat(". ")+n.concat(". ")+a.Publisher.name,s=r.length>e.descriptionLimit?r.slice(0,e.descriptionLimit).concat("..."):r,i=[];i.previewData={},i.previewData["Название"]=o,i.previewData["Авторы"]=n,i.previewData["Издатель"]=a.Publisher.name,i.previewData["Предмет"]=a.Subject.name,i.previewData["Классы"]=a.grades,i.previewData["Уровень"]=a.Level.name,i.previewData["Пользовательская"]=a.isCustom?"Да":"Нет",i.entry=a,t.push({Description:s,emc:i})}return t}),[])}}),watch:{routeParams:function(){this.model=null,this.getEmc()}},created:function(){this.getEmc()},methods:{getEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Fe.getEmcToAttach(Object(u["a"])({},e.activeRouteParams));case 3:a=t.sent,e.emcs=a.data.emcs,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.error=t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},attachEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Fe.attachTo(Object(u["a"])(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),e.additionalDataForEmcOnSchool),{},{emcId:e.model.entry.id}));case 3:e.activeRouteParams=Object(u["a"])({},e.activeRouteParams),e.model=null,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.error=t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}}}),gt=bt,ft=a("c6a6"),_t=Object(g["a"])(gt,ht,pt,!1,null,null,null),Ot=_t.exports;_()(_t,{VAutocomplete:ft["a"],VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VCol:fe["a"],VExpandTransition:st["a"],VIcon:et["a"],VList:H["a"],VListItem:I["a"],VListItemContent:T["a"],VListItemSubtitle:T["b"],VListItemTitle:T["c"],VRow:Oe["a"],VSpacer:C["a"],VTextField:xe["a"]});var xt={components:{EmcOnSchoolCard:vt,EmcOnSchoolSelector:Ot},data:function(){return{error:null,page:1,totalPages:1,limit:5}},computed:Object(u["a"])(Object(u["a"])({},Object(r["b"])(["activeRouteParams","activeSidebar","emcsOnSchool","isSignin","user","emcs","subjects","areas"])),{},{subjectTitle:function(){var e,t,a=this;return null!==(e=null===(t=this.subjects.find((function(e){var t;return e.id===(null===(t=a.activeRouteParams)||void 0===t?void 0:t.subjectId)})))||void 0===t?void 0:t.name)&&void 0!==e?e:"Все предметы"},routeParams:function(){return this.activeRouteParams}}),watch:{routeParams:function(){this.getEmcOnSchool(),this.getEmc()},page:function(){this.getEmcOnSchool()}},created:function(){this.activeSidebar="admin",this.getEmcOnSchool(),this.getEmc()},methods:{getEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Fe.getEmcToAttach(Object(u["a"])({},e.activeRouteParams));case 3:a=t.sent,console.log(Object(u["a"])({msg:"get_emcs_for_attach"},a.data)),e.emcs=a.data.emcs,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.error=t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},getEmcOnSchool:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Fe.getEmcOnSchool(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),{},{skip:(e.page-1)*e.limit,limit:e.limit}));case 3:a=t.sent,console.log({msg:"get_emcs_on_school",totalEmcsOnSchool:a.data.totalEmcsOnSchool,emcsOnSchool:a.data.emcsOnSchool}),e.emcsOnSchool=a.data.emcsOnSchool,e.totalPages=Math.ceil(a.data.totalEmcsOnSchool/e.limit),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.error=t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},detachEmcFrom:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Fe.detachFrom(Object(u["a"])(Object(u["a"])({},t.activeRouteParams),{},{emcOnSchoolId:e.id}));case 3:t.activeRouteParams=Object(u["a"])({},t.activeRouteParams),a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),t.error=a.t0;case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()},swapApprovingStatusEmcOnSchool:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Fe.updateEmcOnSchool({emcOnSchoolId:e.id,isApproved:!e.isApproved});case 3:t.activeRouteParams=Object(u["a"])({},t.activeRouteParams),a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),t.error=a.t0;case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()}}},St=xt,Ct=a("891e"),jt=Object(g["a"])(St,Ne,qe,!1,null,"19282db3",null),Et=jt.exports;_()(jt,{VCard:Xe["a"],VCol:fe["a"],VContainer:rt["a"],VPagination:Ct["a"],VRow:Oe["a"]});var wt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&1==e.user.UserRole.code?a("v-container",{staticClass:"px-0",attrs:{fluid:""}},[null==e.emc?a("v-card",[a("v-card-title",{staticClass:"text-h4 text-center"},[e._v(" Подождите...Данные либо грузятся, либо произошла ошибка. "),a("br"),e._v(" Попробуйте перезайти и попробовать снова ")])],1):e._e(),null!=e.emc?a("v-card",[a("v-card-title",{staticClass:"text-h4"},[e._v(" Редактирование УМК ")]),a("v-card-text",{staticClass:"text-h5"},[a("v-text-field",{attrs:{label:"Название"},model:{value:e.emc.title,callback:function(t){e.$set(e.emc,"title",t)},expression:"emc.title"}}),a("v-text-field",{attrs:{label:"Авторы"},model:{value:e.emc.authors,callback:function(t){e.$set(e.emc,"authors",t)},expression:"emc.authors"}}),a("v-text-field",{attrs:{label:"Класс"},model:{value:e.emc.grades,callback:function(t){e.$set(e.emc,"grades",t)},expression:"emc.grades"}}),a("v-select",{attrs:{items:e.subjects,"item-text":"name","no-data-text":"Нет данных",label:"Предмет","return-object":""},model:{value:e.emc.Subject,callback:function(t){e.$set(e.emc,"Subject",t)},expression:"emc.Subject"}}),a("v-select",{attrs:{items:e.levels,"item-text":"name","no-data-text":"Нет данных",label:"Уровень","return-object":""},model:{value:e.emc.Level,callback:function(t){e.$set(e.emc,"Level",t)},expression:"emc.Level"}}),a("v-select",{attrs:{items:e.publishers,"item-text":"name",label:"Издательство","no-data-text":"Нет данных","return-object":""},model:{value:e.emc.Publisher,callback:function(t){e.$set(e.emc,"Publisher",t)},expression:"emc.Publisher"}}),e.emc.createdBy?a("v-checkbox",{attrs:{label:"Пользовательский"},model:{value:e.emc.isCustom,callback:function(t){e.$set(e.emc,"isCustom",t)},expression:"emc.isCustom"}}):e._e()],1),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:e.saveEmc}},[e._v(" Сохранить изменения ")]),a("v-spacer"),a("v-btn",{attrs:{text:"",color:"red accent-2"},on:{click:function(t){return e.goTo()}}},[e._v(" Отменить редактирование ")])],1)],1):e._e()],1):e._e()},kt=[],Rt=a("15fd"),Pt=a("3835"),Vt=["emcId","from"],It={data:function(){return{loading:!1,error:null,message:null,emc:null}},computed:Object(u["a"])({},Object(r["b"])(["activeRouteParams","activeSidebar","isSignin","subjects","publishers","levels","user"])),created:function(){this.activeSidebar=null,this.getEmcForEdit()},methods:{getEmcForEdit:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Fe.getEmc(Object(u["a"])({},e.activeRouteParams));case 3:a=t.sent,200===a.status?(c=Object(Pt["a"])(a.data.emcs,1),o=c[0],e.emc=o):e.goTo(),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.error=t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},saveEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log("save this.emc : ",e.emc),t.next=4,Fe.updateEmc(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),{},{emc:Object(u["a"])(Object(u["a"])({},e.emc),{},{publisherId:e.emc.Publisher.id,levelId:e.emc.Level.id,subjectId:e.emc.Subject.id})}));case 4:e.goTo(),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.error=t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},goTo:function(){var e=this.activeRouteParams,t=(e.emcId,e.from),a=Object(Rt["a"])(e,Vt);this.activeRouteParams=Object(u["a"])({},a),this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)}))}}},Tt=It,Dt=a("ac7c"),zt=a("b974"),At=Object(g["a"])(Tt,wt,kt,!1,null,null,null),$t=At.exports;_()(At,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VCheckbox:Dt["a"],VContainer:rt["a"],VSelect:zt["a"],VSpacer:C["a"],VTextField:xe["a"]});var yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&1==e.user.UserRole.code?a("v-container",{staticClass:"px-0",attrs:{fluid:""}},[a("v-card",[a("v-card-title",{staticClass:"text-h4"},[e._v(" Создание УМК ")]),a("v-card-text",{staticClass:"text-h5"},[a("v-text-field",{attrs:{label:"Название",placeholder:"Введите название умк"},model:{value:e.emc.title,callback:function(t){e.$set(e.emc,"title",t)},expression:"emc.title"}}),a("v-text-field",{attrs:{label:"Авторы",placeholder:"Введите автора умк"},model:{value:e.emc.authors,callback:function(t){e.$set(e.emc,"authors",t)},expression:"emc.authors"}}),a("v-text-field",{attrs:{label:"Класс",placeholder:"Введите классы умк"},model:{value:e.emc.grades,callback:function(t){e.$set(e.emc,"grades",t)},expression:"emc.grades"}}),a("v-select",{attrs:{items:e.levels,"item-text":"name","no-data-text":"Нет данных",label:"Уровень",solo:"","return-object":""},model:{value:e.emc.Level,callback:function(t){e.$set(e.emc,"Level",t)},expression:"emc.Level"}}),a("v-select",{attrs:{items:e.publishers,"item-text":"name","no-data-text":"Нет данных",label:"Издательство",placeholder:"Выберите издательство умк",solo:"","return-object":""},model:{value:e.emc.Publisher,callback:function(t){e.$set(e.emc,"Publisher",t)},expression:"emc.Publisher"}}),a("v-select",{attrs:{items:e.subjects,"item-text":"name","no-data-text":"Нет данных",label:"Предмет",placeholder:"Выберите предмет умк",solo:"","return-object":""},model:{value:e.emc.Subject,callback:function(t){e.$set(e.emc,"Subject",t)},expression:"emc.Subject"}})],1),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:e.createEmc}},[e._v(" Создать УМК ")]),a("v-btn",{attrs:{text:"",color:"red accent-2",to:{name:"admin-emc"}}},[e._v(" Назад ")])],1)],1)],1):e._e()},Ft=[],Lt={data:function(){return{error:null,message:null,emc:{title:null,grades:null,authors:null,levelId:null,Level:null,subjectId:null,Subject:null,publisherId:null,Publisher:null,isCustom:!1}}},computed:Object(u["a"])({},Object(r["b"])(["activeRouteParams","isSignin","user","publishers","subjects","levels"])),created:function(){this.activeSidebar=null},methods:{createEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,null!=e.emc.title&&null!=e.emc.authors&&null!=e.emc.grades&&null!=e.emc.Publisher&&null!=e.emc.Subject&&null!=e.emc.Level){t.next=3;break}throw Error("Один из параметров не указан");case 3:return console.log("creating emc ",e.emc),t.next=6,Fe.createEmc({emc:e.emc});case 6:e.activeRouteParams={subjectId:e.emc.Subject.id},e.$router.push({name:"admin-emc"}),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.error=t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}}},Mt=Lt,Ut=Object(g["a"])(Mt,yt,Ft,!1,null,null,null),Bt=Ut.exports;_()(Ut,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VContainer:rt["a"],VSelect:zt["a"],VTextField:xe["a"]});var Nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&1==e.user.UserRole.code?a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"12"}},[a("h1",{staticClass:"text-center"},[e._v(e._s(e.subjectTitle))])]),a("v-col",{attrs:{cols:"12"}},[a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.goTo({name:"admin-emc-create"})}}},[e._v(" Создать УМК ")])],1),a("v-col",{attrs:{cols:"12"}},[0===e.emcs.length?a("v-card",{staticClass:"mx-auto text-center"},[e._v(" Учебников по этому предмету нету ")]):e._e()],1),a("v-col",{attrs:{cols:"12"}},e._l(e.emcs,(function(t){return a("v-card",{key:t.id},[a("v-card-title",{staticClass:"text-h4"},[e._v(" "+e._s(t.title)+" ")]),a("v-card-text",{staticClass:"text-h5"},[a("div",[a("v-chip",{directives:[{name:"show",rawName:"v-show",value:t.isCustom,expression:"emc.isCustom"}],attrs:{color:"red","text-color":"white",pill:""}},[e._v(" Пользовательский ")])],1),a("p",[a("strong",[e._v(" Издательство: ")]),e._v(" "+e._s(t.Publisher.name))]),a("p",[a("strong",[e._v(" Авторы: ")]),e._v(" "+e._s(t.authors))]),a("p",[a("strong",[e._v(" Класс: ")]),e._v(" "+e._s(t.grades))]),a("p",[a("strong",[e._v(" Уровень: ")]),e._v(" "+e._s(t.Level?t.Level.name:"Нет данных"))]),9==t.gia?a("v-chip",{attrs:{color:"indigo lighten-2","text-color":"white",pill:""}},[e._v(" ГИА-"+e._s(t.gia)+" ")]):e._e(),11==t.gia?a("v-chip",{attrs:{color:"light-blue accent-3","text-color":"white",pill:""}},[e._v(" ГИА-"+e._s(t.gia)+" ")]):e._e(),a("v-chip",{attrs:{color:"light-blue accent-3","text-color":"white",pill:""}},[e._v(" "+e._s(t.Subject.name)+" ")])],1),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(a){return e.goTo({name:"admin-emc-edit",params:{emcId:t.id,from:"admin-emc"}})}}},[e._v(" Редактировать ")]),t.createBy?a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.swapCreatingStatusEmc("emc")}}},[t.isCustom?a("div",[e._v("Сделать официальным (не работает вроде)")]):a("div",[e._v("Сделать снова пользовательским (не работает вроде)")])]):e._e(),a("v-spacer"),a("v-btn",{attrs:{text:"",color:"red darken-1"},on:{click:function(a){return e.deleteEmc({emc:t})}}},[e._v(" Удалить ")])],1)],1)})),1),a("v-col",{attrs:{cols:"12"}},[a("v-pagination",{attrs:{length:e.totalPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)],1):e._e()},qt=[],Gt=["emcId"],Ht={data:function(){return{error:null,page:1,totalPages:1,limit:5}},computed:Object(u["a"])(Object(u["a"])({},Object(r["b"])(["subjects","isSignin","user","emcs","activeRouteParams","activeSidebar"])),{},{routeParams:function(){return this.activeRouteParams},subjectTitle:function(){var e,t,a=this;return null!==(e=null===(t=this.subjects.find((function(e){var t;return e.id===(null===(t=a.activeRouteParams)||void 0===t?void 0:t.subjectId)})))||void 0===t?void 0:t.name)&&void 0!==e?e:"Все предметы"}}),watch:{routeParams:function(){this.getEmcForConstructor()},page:function(){this.getEmcForConstructor()}},created:function(){this.activeSidebar="subjects",this.getEmcForConstructor()},methods:{getEmcForConstructor:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Fe.getEmc(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),{},{skip:(e.page-1)*e.limit,limit:e.limit}));case 3:a=t.sent,console.log({msg:"response: ",emcs:a.data.emcs,totalEmcs:a.data.totalEmcs}),e.emcs=a.data.emcs,e.totalPages=Math.ceil(a.data.totalEmcs/e.limit),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.error=t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},swapCreatingStatusEmc:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,null==e.createdBy){a.next=5;break}return a.next=4,Fe.updateEmc(Object(u["a"])(Object(u["a"])({},t.activeRouteParams),{},{emc:e}));case 4:t.activeRouteParams=Object(u["a"])({},t.activeRouteParams);case 5:a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),t.error=a.t0;case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},deleteEmc:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){var c,o,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return c=e.emc,a.prev=1,a.next=4,Fe.deleteEmc({emcId:c.id});case 4:o=t.activeRouteParams,o.emcId,n=Object(Rt["a"])(o,Gt),t.activeRouteParams=Object(u["a"])({},n),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](1),t.error=a.t0;case 11:case"end":return a.stop()}}),a,null,[[1,8]])})))()},goTo:function(e){var t=e.name,a=e.params;d.a.isEqual(this.activeRouteParams,a)||(this.activeRouteParams=Object(u["a"])(Object(u["a"])({},this.activeRouteParams),a),this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})))}}},Jt=Ht,Kt=Object(g["a"])(Jt,Nt,qt,!1,null,null,null),Qt=Kt.exports;_()(Kt,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VChip:nt["a"],VCol:fe["a"],VPagination:Ct["a"],VRow:Oe["a"],VSpacer:C["a"]});var Wt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&2==e.user.UserRole.code?a("v-row",[a("v-col",[e._v(" PMO ")])],1):e._e()},Xt=[],Yt={getUserData:function(){return he().post("/pmo")},getEmcOnSchool:function(e){var t=e.schoolId,a=e.subjectId,c=e.skip,o=e.limit;return console.log("pmo service ",{subjectId:a,schoolId:t,skip:c,limit:o}),he().post("/pmo/list_emc_on_school",{schoolId:t,subjectId:a,skip:c,limit:o})},getEmc:function(e){var t=e.emcId,a=e.subjectId,c=e.schoolId,o=e.skip,n=e.limit;return he().post("/pmo/list_emc",{emcId:t,subjectId:a,schoolId:c,skip:o,limit:n})},getEmcToAttach:function(e){var t=e.subjectId,a=e.schoolId,c=e.skip,o=e.limit;return he().post("/pmo/list_emc_to_attach",{subjectId:t,schoolId:a,skip:c,limit:o})},updateEmc:function(e){var t=e.subjectId,a=e.schoolId,c=e.skip,o=e.limit,n=e.emc;return he().post("/pmo/update_emc",{subjectId:t,schoolId:a,skip:c,limit:o,emc:n})},deleteEmc:function(e){var t=e.emcId;return he().post("/pmo/delete_emc",{emcId:t})},updateEmcOnSchool:function(e){var t=e.emcId,a=e.usingCoz,c=e.correctionCoz,o=e.swapCoz,n=e.studentsCount;return he().post("/pmo/update_emc_on_school",{emcId:t,usingCoz:a,correctionCoz:c,swapCoz:o,studentsCount:n})},createEmc:function(e){var t=e.emc;return he().post("/pmo/create_emc",{title:t.title,authors:t.authors,grades:t.grades,publisherId:t.Publisher.id,subjectId:t.Subject.id,levelId:t.Level.id})},attachTo:function(e){var t=e.emcId,a=e.subjectId,c=e.schoolId,o=e.swapCoz,n=e.usingCoz,r=e.correctionCoz,s=e.studentsCount;return he().post("/pmo/attach_emc",{emcId:t,subjectId:a,swapCoz:o,usingCoz:n,correctionCoz:r,studentsCount:s,schoolId:c})},detachFrom:function(e){var t=e.schoolId,a=e.subjectId,c=e.emcOnSchoolId;return he().post("/pmo/detach_emc",{subjectId:a,schoolId:t,emcOnSchoolId:c})}},Zt={computed:Object(u["a"])({},Object(r["b"])(["isSignin","user","schools","subjects","levels","publishers","activeSidebar"])),created:function(){this.init(),this.activeSidebar=null},methods:{init:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Yt.getUserData();case 3:a=t.sent,e.schools=a.data.schools,e.subjects=a.data.subjects,e.publishers=a.data.publishers,e.levels=a.data.levels,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.err=t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}}},ea=Zt,ta=Object(g["a"])(ea,Wt,Xt,!1,null,"748da050",null),aa=ta.exports;_()(ta,{VCol:fe["a"],VRow:Oe["a"]});var ca=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&2==e.user.UserRole.code?a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("h1",{staticClass:"text-center"},[e._v(e._s(e.subjectTitle))])])],1),a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"12"}},[e.activeRouteParams&&e.activeRouteParams.subjectId?a("EmcOnSchoolSelector"):e._e()],1),0==e.emcsOnSchool.length?a("v-card",{staticClass:"mx-auto text-center"},[e._v(" Отсутствуют УМК ")]):e._e(),a("v-col",{attrs:{cols:"12"}},e._l(e.emcsOnSchool,(function(t){return a("v-row",{key:t.id},[a("EmcOnSchoolCard",{attrs:{"emc-on-school":t},on:{onDetachEmcFrom:e.detachEmcFrom,onSwapApprovingStatusEmcOnSchool:e.swapApprovingStatusEmcOnSchool}})],1)})),1),e.emcsOnSchool.length>0?a("v-col",{attrs:{cols:"12"}},[a("v-pagination",{attrs:{length:e.totalPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1):e._e()],1)],1):e._e()},oa=[],na=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"px-0",attrs:{fluid:""}},[a("v-card",[a("v-card-title",{staticClass:"text-h4"},[e._v(" УМК: "+e._s(e.emcOnSchool.EMC.title)+" ")]),a("v-card-text",{staticClass:"text-h5"},[a("div",[a("v-chip",{directives:[{name:"show",rawName:"v-show",value:e.emcOnSchool.isApproved,expression:"emcOnSchool.isApproved"}],attrs:{color:"green","text-color":"white",pill:""}},[e._v(" Утверждено ")]),a("v-chip",{directives:[{name:"show",rawName:"v-show",value:!e.emcOnSchool.isApproved,expression:"!emcOnSchool.isApproved"}],attrs:{color:"yellow","text-color":"black",pill:""}},[e._v(" Не утверждено ")]),a("v-chip",{directives:[{name:"show",rawName:"v-show",value:e.emcOnSchool.EMC.isCustom&&e.emcOnSchool.EMC.createdBy===e.user.id,expression:"emcOnSchool.EMC.isCustom && emcOnSchool.EMC.createdBy === user.id"}],attrs:{color:"red","text-color":"white",pill:""}},[e._v(" Создано вами ")]),9==e.emcOnSchool.EMC.gia?a("v-chip",{attrs:{color:"indigo lighten-2","text-color":"white",pill:""}},[e._v(" ГИА-"+e._s(e.emcOnSchool.EMC.gia)+" ")]):e._e(),11==e.emcOnSchool.EMC.gia?a("v-chip",{attrs:{color:"light-blue accent-3","text-color":"white",pill:""}},[e._v(" ГИА-"+e._s(e.emcOnSchool.EMC.gia)+" ")]):e._e(),a("v-chip",{attrs:{color:"green","text-color":"white",pill:""}},[e._v(" "+e._s(e.emcOnSchool.School.schoolName)+" "+e._s(e.emcOnSchool.School.schoolCode)+" ")])],1),a("p",[a("strong",[e._v("Издательство:")]),e._v(" "+e._s(e.emcOnSchool.EMC.Publisher.publisherName))]),a("p",[a("strong",[e._v("Авторы:")]),e._v(" "+e._s(e.emcOnSchool.EMC.authors))]),a("p",[a("strong",[e._v("Класс:")]),e._v(" "+e._s(e.emcOnSchool.EMC.grades))]),a("p",[a("strong",[e._v("Кол-во учеников:")]),e._v(" "+e._s(e.emcOnSchool.studentsCount))]),a("p",[a("strong",[e._v("Уровень:")]),e._v(" "+e._s(e.emcOnSchool.EMC.Level?e.emcOnSchool.EMC.Level.name:"Нет данных")+" ")])]),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){e.isDetailing=!e.isDetailing}}},[e._v(" Комментарии ")]),a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.$emit("onSwapApprovingStatusEmcOnSchool",e.emcOnSchool)}}},[e._v(" "+e._s(e.emcOnSchool.isApproved?"Отменить утверждение":"Утвердить")+" ")]),e.emcOnSchool.EMC.isCustom&&e.emcOnSchool.EMC.createdBy===e.user.id?a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.goTo({name:"pmo-emc-edit",params:{emcId:e.emcOnSchool.emcId,from:"pmo-emc-on-school"}})}}},[e._v(" Редактировать ")]):e._e(),a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.$emit("onDetachEmcFrom",e.emcOnSchool)}}},[e._v(" Открепить УМК ")]),a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.$emit("onDetachEmcFrom",e.emcOnSchool)}}},[e._v(" Открепить УМК от всех ОО ")])],1),a("v-expand-transition",[a("v-card",{directives:[{name:"show",rawName:"v-show",value:e.isDetailing,expression:"isDetailing"}]},[a("v-tabs",{attrs:{"background-color":"transparent",color:"basil",grow:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab",[e._v("Кол-во учеников")]),a("v-tab",[e._v("Причина использования")]),a("v-tab",[e._v("Причина изменения")]),a("v-tab",[e._v("Причина смены")])],1),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{"additional-eos-title":"Кол-во учеников","additional-eos-data-value":e.emcOnSchool.studentsCount,"is-number":!0},on:{"on-save-additional-data":e.saveStudentsCount}}),e._v(" "+e._s(e.emcOnSchool.studentsCount))],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{"additional-eos-title":"Причина использования","additional-eos-data-value":e.emcOnSchool.usingCoz},on:{"on-save-additional-data":e.saveUsingCozComment}}),e._v(" "+e._s(e.emcOnSchool.usingCoz)+" ")],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{"additional-eos-title":"Причина изменения","additional-eos-data-value":e.emcOnSchool.correctionCoz},on:{"on-save-additional-data":e.saveCorrectionCozComment}}),e._v(" "+e._s(e.emcOnSchool.correctionCoz))],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{"additional-eos-title":"Причина смены","additional-eos-data-value":e.emcOnSchool.swapCoz},on:{"on-save-additional-data":e.saveSwapCozComment}}),e._v(" "+e._s(e.emcOnSchool.swapCoz))],1)],1)],1)],1)],1)],1)],1)],1)},ra=[],sa={components:{TheEditAdditionalEOSData:at},props:{emcOnSchool:{type:Object,default:null}},data:function(){return{error:null,tab:null,isDetailing:!1}},computed:Object(u["a"])({},Object(r["b"])(["activeRouteParams","isSignin","user","emcs","emcsOnSchool"])),methods:{saveUsingCozComment:function(e){this.updateEmcOnSchool({usingCoz:e})},saveCorrectionCozComment:function(e){this.updateEmcOnSchool({correctionCoz:e})},saveSwapCozComment:function(e){this.updateEmcOnSchool({swapCoz:e})},saveStudentsCount:function(e){this.updateEmcOnSchool({studentsCount:e})},updateEmcOnSchool:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Yt.updateEmcOnSchool(Object(u["a"])({emcOnSchoolId:t.emcOnSchool.id},e));case 3:t.activeRouteParams=Object(u["a"])({},t.activeRouteParams),a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),t.error=a.t0;case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()},goTo:function(e){var t=e.name,a=e.params;d.a.isEqual(this.activeRouteParams,a)||(this.activeRouteParams=Object(u["a"])(Object(u["a"])({},this.activeRouteParams),a),this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})))}}},ia=sa,la=(a("e627"),Object(g["a"])(ia,na,ra,!1,null,"1a782130",null)),ua=la.exports;_()(la,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VChip:nt["a"],VContainer:rt["a"],VExpandTransition:st["a"],VTab:it["a"],VTabItem:lt["a"],VTabs:ut["a"],VTabsItems:mt["a"]});var ma=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",{staticClass:"text-h5"},[e._v(" Добавить УМК ")]),a("v-card-text",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-autocomplete",{attrs:{items:e.emcsTitles,"no-data-text":"Нет данных","item-text":"Description","item-value":"emc",dense:"",solo:"","hide-selected":"",label:"УМК",placeholder:"Введите параметр УМК, по которому вы хотите найти нужный","prepend-icon":"mdi-database-search"},scopedSlots:e._u([{key:"item",fn:function(t){return[a("v-list-item-content",[a("v-list-item-title",[e._v(e._s(t.item.emc.previewData["Название"]))]),a("v-list-item-subtitle",[a("p",[e._v(" Авторы: "+e._s(t.item.emc.previewData["Авторы"])+"; Издатель: "+e._s(t.item.emc.previewData["Издатель"])+"; Классы: "+e._s(t.item.emc.previewData["Классы"])+" ")])])],1)]}}]),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1)],1),a("v-expand-transition",[e.model?a("v-list",[e._l(e.fields,(function(t,c){return a("v-list-item",{key:c},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:e._s(t.value)}}),a("v-list-item-subtitle",{domProps:{textContent:e._s(t.key)}})],1)],1)})),a("v-list-item",[a("v-text-field",{attrs:{type:"number",label:"Количество учеников"},model:{value:e.additionalDataForEmcOnSchool.studentsCount,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"studentsCount",t)},expression:"additionalDataForEmcOnSchool.studentsCount"}})],1),a("v-list-item",[a("v-text-field",{attrs:{label:"Причины использования"},model:{value:e.additionalDataForEmcOnSchool.usingCoz,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"usingCoz",t)},expression:"additionalDataForEmcOnSchool.usingCoz"}})],1),a("v-list-item",[a("v-text-field",{attrs:{label:"Причины смены"},model:{value:e.additionalDataForEmcOnSchool.swapCoz,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"swapCoz",t)},expression:"additionalDataForEmcOnSchool.swapCoz"}})],1),a("v-list-item",[a("v-text-field",{attrs:{label:"Планируемая корректировка"},model:{value:e.additionalDataForEmcOnSchool.correctionCoz,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"correctionCoz",t)},expression:"additionalDataForEmcOnSchool.correctionCoz"}})],1)],2):e._e()],1),a("v-card-actions",[a("v-btn",{attrs:{disabled:!e.model,color:"teal accent-3"},on:{click:e.attachEmc}},[e._v(" Добавить "),a("v-icon",{attrs:{right:""}},[e._v(" mdi-check ")])],1),a("v-spacer"),a("v-btn",{attrs:{disabled:!e.model,color:"red lighten-1"},on:{click:function(t){e.model=null}}},[e._v(" Закрыть "),a("v-icon",{attrs:{right:""}},[e._v(" mdi-close-circle ")])],1)],1)],1)},da=[],va={data:function(){return{model:null,additionalDataForEmcOnSchool:{swapCoz:null,usingCoz:null,correctionCoz:null,studentsCount:0},descriptionLimit:200,error:null}},computed:Object(u["a"])(Object(u["a"])({},Object(r["b"])(["emcs","emcsOnSchool","user","activeRouteParams"])),{},{routeParams:function(){return this.activeRouteParams},fields:function(){var e=this;return this.model?Object.keys(this.model.previewData).map((function(t){return{key:e.model.previewData[t],value:t}})):[]},emcsTitles:function(){var e=this;return this.emcs.reduce((function(t,a){if(a&&a.Subject.id===e.activeRouteParams.subjectId&&0===e.emcsOnSchool.filter((function(t){return t.emcId===a.id&&t.School.id===e.activeRouteParams.schoolId})).length){var c=null==a.title?"Нет имени":a.title,o=null==a.authors?"Нет авторов":a.authors,n=c.concat(". ")+o.concat(". ")+a.Publisher.name,r=n.length>e.descriptionLimit?n.slice(0,e.descriptionLimit).concat("..."):n,s=[];s.previewData={},s.previewData["Название"]=c,s.previewData["Авторы"]=o,s.previewData["Издатель"]=a.Publisher.name,s.previewData["Предмет"]=a.Subject.name,s.previewData["Классы"]=a.grades,s.previewData["Уровень"]=a.Level.name,s.previewData["Создана вами"]=a.createdBy===e.user.id?"Да":"Нет",s.entry=a,t.push({Description:r,emc:s})}return t}),[])}}),watch:{routeParams:function(){this.model=null,this.getEmc()}},created:function(){this.getEmc()},methods:{getEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Yt.getEmcToAttach(Object(u["a"])({},e.activeRouteParams));case 3:a=t.sent,e.emcs=a.data.emcs,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.error=t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},attachEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log(Object(u["a"])(Object(u["a"])(Object(u["a"])({msg:"trying to attach"},e.activeRouteParams),e.additionalDataForEmcOnSchool),{},{emcId:e.model.entry.id})),t.next=4,Yt.attachTo(Object(u["a"])(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),e.additionalDataForEmcOnSchool),{},{emcId:e.model.entry.id}));case 4:a=t.sent,console.log(Object(u["a"])({msg:"response_about_attaching"},a.data)),e.activeRouteParams=Object(u["a"])({},e.activeRouteParams),e.model=null,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.error=t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}}},ha=va,pa=Object(g["a"])(ha,ma,da,!1,null,null,null),ba=pa.exports;_()(pa,{VAutocomplete:ft["a"],VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VCol:fe["a"],VExpandTransition:st["a"],VIcon:et["a"],VList:H["a"],VListItem:I["a"],VListItemContent:T["a"],VListItemSubtitle:T["b"],VListItemTitle:T["c"],VRow:Oe["a"],VSpacer:C["a"],VTextField:xe["a"]});var ga={components:{EmcOnSchoolCard:ua,EmcOnSchoolSelector:ba},data:function(){return{error:null,page:1,totalPages:1,limit:5}},computed:Object(u["a"])(Object(u["a"])({},Object(r["b"])(["activeRouteParams","emcsOnSchool","isSignin","user","emcs","subjects","activeSidebar"])),{},{subjectTitle:function(){var e,t,a=this;return null!==(e=null===(t=this.subjects.find((function(e){var t;return e.id===(null===(t=a.activeRouteParams)||void 0===t?void 0:t.subjectId)})))||void 0===t?void 0:t.name)&&void 0!==e?e:"Все предметы"},routeParams:function(){return this.activeRouteParams}}),watch:{routeParams:function(){this.getEmcOnSchool(),this.getEmc()},page:function(){this.getEmcOnSchool()}},created:function(){this.activeSidebar="pmo",this.getEmcOnSchool(),this.getEmc()},methods:{getEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Yt.getEmcToAttach(Object(u["a"])({},e.activeRouteParams));case 3:a=t.sent,console.log(Object(u["a"])({msg:"get_emcs_for_attach"},a.data)),e.emcs=a.data.emcs,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.error=t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},getEmcOnSchool:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Yt.getEmcOnSchool(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),{},{skip:(e.page-1)*e.limit,limit:e.limit}));case 3:a=t.sent,console.log(Object(u["a"])(Object(u["a"])({msg:"get_emcs_on_school"},e.activeRouteParams),{},{skip:(e.page-1)*e.limit,limit:e.limit,totalEmcsOnSchool:a.data.totalEmcsOnSchool,emcsOnSchool:a.data.emcsOnSchool})),e.emcsOnSchool=a.data.emcsOnSchool,e.totalPages=Math.ceil(a.data.totalEmcsOnSchool/e.limit),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.error=t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},detachEmcFrom:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Yt.detachFrom(Object(u["a"])(Object(u["a"])({},t.activeRouteParams),{},{emcOnSchoolId:e.id}));case 3:t.activeRouteParams=Object(u["a"])({},t.activeRouteParams),a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),t.error=a.t0;case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()},swapApprovingStatusEmcOnSchool:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Yt.updateEmcOnSchool({emcOnSchoolId:e.id,isApproved:!e.isApproved});case 3:t.activeRouteParams=Object(u["a"])({},t.activeRouteParams),a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),t.error=a.t0;case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()}}},fa=ga,_a=Object(g["a"])(fa,ca,oa,!1,null,"9dd33bf8",null),Oa=_a.exports;_()(_a,{VCard:Xe["a"],VCol:fe["a"],VContainer:rt["a"],VPagination:Ct["a"],VRow:Oe["a"]});var xa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&2==e.user.UserRole.code?a("v-container",{staticClass:"px-0",attrs:{fluid:""}},[null==e.emc?a("v-card",[a("v-card-title",{staticClass:"text-h4 text-center"},[e._v(" Подождите...Данные либо грузятся, либо произошла ошибка. "),a("br"),e._v(" Попробуйте перезайти и попробовать снова ")])],1):e._e(),null!=e.emc?a("v-card",[a("v-card-title",{staticClass:"text-h4"},[e._v(" Редактирование УМК ")]),a("v-card-text",{staticClass:"text-h5"},[a("v-text-field",{attrs:{label:"Название"},model:{value:e.emc.title,callback:function(t){e.$set(e.emc,"title",t)},expression:"emc.title"}}),a("v-text-field",{attrs:{label:"Авторы"},model:{value:e.emc.authors,callback:function(t){e.$set(e.emc,"authors",t)},expression:"emc.authors"}}),a("v-text-field",{attrs:{label:"Класс"},model:{value:e.emc.grades,callback:function(t){e.$set(e.emc,"grades",t)},expression:"emc.grades"}}),a("v-select",{attrs:{items:e.subjects,"item-text":"name","no-data-text":"Нет данных",label:"Предмет","return-object":""},model:{value:e.emc.Subject,callback:function(t){e.$set(e.emc,"Subject",t)},expression:"emc.Subject"}}),a("v-select",{attrs:{items:e.levels,"item-text":"name","no-data-text":"Нет данных",label:"Уровень","return-object":""},model:{value:e.emc.Level,callback:function(t){e.$set(e.emc,"Level",t)},expression:"emc.Level"}}),a("v-select",{attrs:{items:e.publishers,"item-text":"name",label:"Издательство","no-data-text":"Нет данных","return-object":""},model:{value:e.emc.Publisher,callback:function(t){e.$set(e.emc,"Publisher",t)},expression:"emc.Publisher"}})],1),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:e.saveEmc}},[e._v(" Сохранить изменения ")]),a("v-spacer"),a("v-btn",{attrs:{text:"",color:"red accent-2"},on:{click:function(t){return e.goTo()}}},[e._v(" Отменить редактирование ")])],1)],1):e._e()],1):e._e()},Sa=[],Ca=["emcId","from"],ja={data:function(){return{loading:!1,error:null,message:null,emc:null}},computed:Object(u["a"])({},Object(r["b"])(["activeRouteParams","isSignin","subjects","publishers","levels","user","activeSidebar"])),created:function(){this.activeSidebar=null,this.getEmcForEdit()},methods:{getEmcForEdit:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Yt.getEmcs(Object(u["a"])({},e.activeRouteParams));case 3:a=t.sent,200===a.status?(c=Object(Pt["a"])(a.data.emcs,1),o=c[0],e.emc=o):e.goTo(),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.error=t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},saveEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Yt.updateEmc(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),{},{emc:Object(u["a"])(Object(u["a"])({},e.emc),{},{publisherId:e.emc.Publisher.id,levelId:e.emc.Level.id,subjectId:e.emc.Subject.id})}));case 3:e.goTo(),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),e.error=t.t0;case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},goTo:function(){var e=this.activeRouteParams,t=(e.emcId,e.from),a=Object(Rt["a"])(e,Ca);this.activeRouteParams=Object(u["a"])({},a),this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)}))}}},Ea=ja,wa=Object(g["a"])(Ea,xa,Sa,!1,null,null,null),ka=wa.exports;_()(wa,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VContainer:rt["a"],VSelect:zt["a"],VSpacer:C["a"],VTextField:xe["a"]});var Ra=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&2==e.user.UserRole.code?a("v-container",{staticClass:"px-0",attrs:{fluid:""}},[a("v-card",[a("v-card-title",{staticClass:"text-h4"},[e._v(" Создание УМК ")]),a("v-card-text",{staticClass:"text-h5"},[a("v-text-field",{attrs:{label:"Название",placeholder:"Введите название умк"},model:{value:e.emc.title,callback:function(t){e.$set(e.emc,"title",t)},expression:"emc.title"}}),a("v-text-field",{attrs:{label:"Авторы",placeholder:"Введите автора умк"},model:{value:e.emc.authors,callback:function(t){e.$set(e.emc,"authors",t)},expression:"emc.authors"}}),a("v-text-field",{attrs:{label:"Класс",placeholder:"Введите классы умк"},model:{value:e.emc.grades,callback:function(t){e.$set(e.emc,"grades",t)},expression:"emc.grades"}}),a("v-select",{attrs:{items:e.levels,"item-text":"name","no-data-text":"Нет данных",label:"Уровень",solo:"","return-object":""},model:{value:e.emc.Level,callback:function(t){e.$set(e.emc,"Level",t)},expression:"emc.Level"}}),a("v-select",{attrs:{items:e.publishers,"item-text":"name","no-data-text":"Нет данных",label:"Издательство",placeholder:"Выберите издательство умк",solo:"","return-object":""},model:{value:e.emc.Publisher,callback:function(t){e.$set(e.emc,"Publisher",t)},expression:"emc.Publisher"}}),a("v-select",{attrs:{items:e.subjects,"item-text":"name","no-data-text":"Нет данных",label:"Предмет",placeholder:"Выберите предмет умк",solo:"","return-object":""},model:{value:e.emc.Subject,callback:function(t){e.$set(e.emc,"Subject",t)},expression:"emc.Subject"}})],1),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:e.createEmc}},[e._v(" Создать УМК ")]),a("v-btn",{attrs:{text:"",color:"red accent-2",to:{name:"pmo-emc"}}},[e._v(" Назад ")])],1)],1)],1):e._e()},Pa=[],Va={data:function(){return{error:null,message:null,emc:{title:null,grades:null,authors:null,levelId:null,Level:null,subjectId:null,Subject:null,publisherId:null,Publisher:null,isCustom:!1}}},computed:Object(u["a"])({},Object(r["b"])(["activeRouteParams","isSignin","user","publishers","subjects","levels","activeSidebar"])),created:function(){this.activeSidebar=null},methods:{createEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,null!=e.emc.title&&null!=e.emc.authors&&null!=e.emc.grades&&null!=e.emc.Publisher&&null!=e.emc.Subject&&null!=e.emc.Level){t.next=3;break}throw Error("Один из параметров не указан");case 3:return console.log("creating emc ",e.emc),t.next=6,Yt.createEmc({emc:e.emc});case 6:e.activeRouteParams={subjectId:e.emc.Subject.id},e.$router.push({name:"pmo-emc"}),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.error=t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}}},Ia=Va,Ta=Object(g["a"])(Ia,Ra,Pa,!1,null,null,null),Da=Ta.exports;_()(Ta,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VContainer:rt["a"],VSelect:zt["a"],VTextField:xe["a"]});var za=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&2==e.user.UserRole.code?a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"12"}},[a("h1",{staticClass:"text-center"},[e._v(e._s(e.subjectTitle))])]),a("v-col",{attrs:{cols:"12"}},[a("v-btn",{attrs:{text:"",color:"teal accent-4",to:{name:"pmo-emc-create"}}},[e._v(" Создать УМК ")])],1),a("v-col",{attrs:{cols:"12"}},[0==e.emcs.length?a("v-card",{staticClass:"mx-auto text-center"},[e._v(" Учебников по этому предмету нету ")]):e._e()],1),a("v-col",{attrs:{cols:"12"}},e._l(e.emcs,(function(t){return a("v-card",{key:t.id},[a("v-card-title",{staticClass:"text-h4"},[e._v(" "+e._s(t.title)+" ")]),a("v-card-text",{staticClass:"text-h5"},[a("div",[a("v-chip",{directives:[{name:"show",rawName:"v-show",value:t.isCustom&&t.createdBy===e.user.id,expression:"emc.isCustom && emc.createdBy === user.id"}],attrs:{color:"red","text-color":"white",pill:""}},[e._v(" Созданный вами ")])],1),a("p",[a("strong",[e._v("Издательство: ")]),e._v(" "+e._s(t.Publisher.name))]),a("p",[a("strong",[e._v("Авторы: ")]),e._v(" "+e._s(t.authors))]),a("p",[a("strong",[e._v("Класс: ")]),e._v(" "+e._s(t.grades))]),a("p",[a("strong",[e._v("Уровень: ")]),e._v(" "+e._s(t.Level?t.Level.name:"Нет данных"))]),9==t.gia?a("v-chip",{attrs:{color:"indigo lighten-2","text-color":"white",pill:""}},[e._v(" ГИА-"+e._s(t.gia)+" ")]):e._e(),11==t.gia?a("v-chip",{attrs:{color:"light-blue accent-3","text-color":"white",pill:""}},[e._v(" ГИА-"+e._s(t.gia)+" ")]):e._e(),a("v-chip",{attrs:{color:"light-blue accent-3","text-color":"white",pill:""}},[e._v(" "+e._s(t.Subject.name)+" ")])],1),a("v-card-actions",[t.isCustom&&t.createdBy===e.user.id?a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(a){return e.goTo({name:"pmo-emc-edit",params:{emcId:t.id}})}}},[e._v(" Редактировать ")]):e._e(),a("v-spacer"),t.isCustom&&t.createdBy===e.user.id?a("v-btn",{attrs:{text:"",color:"red darken-1"},on:{click:function(a){return e.deleteEmc({emc:t})}}},[e._v(" Удалить ")]):e._e()],1)],1)})),1)],1):e._e()},Aa=[],$a=["emcId"],ya={data:function(){return{error:null,page:1,totalPages:1,limit:5}},computed:Object(u["a"])(Object(u["a"])({},Object(r["b"])(["activeRouteParams","subjects","isSignin","user","emcs","activeSidebar"])),{},{subjectTitle:function(){var e,t,a=this;return null!==(e=null===(t=this.subjects.find((function(e){var t;return e.id===(null===(t=a.activeRouteParams)||void 0===t?void 0:t.subjectId)})))||void 0===t?void 0:t.name)&&void 0!==e?e:"Все предметы"},routeParams:function(){return this.activeRouteParams}}),watch:{routeParams:function(){this.page=1,this.getEmcForConstructor()},page:function(){this.getEmcForConstructor()}},created:function(){this.activeSidebar="subjects",this.getEmcForConstructor()},methods:{getEmcForConstructor:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Yt.getEmc(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),{},{skip:(e.page-1)*e.limit,limit:e.limit}));case 3:a=t.sent,console.log({msg:"response: ",emcs:a.data.emcs,totalEmcs:a.data.totalEmcs}),e.emcs=a.data.emcs,e.totalPages=Math.ceil(a.data.totalEmcs/e.limit),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.error=t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},deleteEmc:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){var c,o,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return c=e.emc,a.prev=1,a.next=4,Yt.deleteEmc({emcId:c.id});case 4:o=t.activeRouteParams,o.emcId,n=Object(Rt["a"])(o,$a),t.activeRouteParams=Object(u["a"])({},n),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](1),t.error=a.t0;case 11:case"end":return a.stop()}}),a,null,[[1,8]])})))()},goTo:function(e){var t=e.name,a=e.params;d.a.isEqual(this.activeRouteParams,a)||(this.activeRouteParams=Object(u["a"])(Object(u["a"])({},this.activeRouteParams),a),this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})))}}},Fa=ya,La=Object(g["a"])(Fa,za,Aa,!1,null,null,null),Ma=La.exports;_()(La,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VChip:nt["a"],VCol:fe["a"],VRow:Oe["a"],VSpacer:C["a"]});var Ua=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&3==e.user.UserRole.code?a("v-row",[a("v-col",[e._v(" POO ")])],1):e._e()},Ba=[],Na={getUserData:function(){return he().post("/poo")},getEmcOnSchool:function(e){var t=e.subjectId,a=e.skip,c=e.limit;return he().post("/poo/list_emc_on_school",{subjectId:t,skip:a,limit:c})},getEmc:function(e){var t=e.emcId,a=e.subjectId,c=e.skip,o=e.limit;return he().post("/poo/list_emc",{emcId:t,subjectId:a,skip:c,limit:o})},getEmcToAttach:function(e){var t=e.subjectId,a=e.skip,c=e.limit;return he().post("/poo/list_emc_to_attach",{subjectId:t,skip:a,limit:c})},updateEmc:function(e){var t=e.subjectId,a=e.skip,c=e.limit,o=e.emc;return he().post("/poo/update_emc",{subjectId:t,skip:a,limit:c,emc:o})},deleteEmc:function(e){var t=e.emcId;return he().post("/poo/delete_emc",{emcId:t})},updateEmcOnSchool:function(e){var t=e.emcOnSchoolId,a=e.usingCoz,c=e.correctionCoz,o=e.swapCoz,n=e.studentsCount;return he().post("/poo/update_emc_on_school",{emcOnSchoolId:t,usingCoz:a,correctionCoz:c,swapCoz:o,studentsCount:n})},createEmc:function(e){var t=e.emc;return he().post("/poo/create_emc",{title:t.title,authors:t.authors,grades:t.grades,publisherId:t.Publisher.id,subjectId:t.Subject.id,levelId:t.Level.id})},attachTo:function(e){var t=e.emcId,a=e.subjectId,c=e.swapCoz,o=e.usingCoz,n=e.correctionCoz,r=e.studentsCount;return he().post("/poo/attach_emc",{emcId:t,subjectId:a,swapCoz:c,usingCoz:o,correctionCoz:n,studentsCount:r})},detachFrom:function(e){var t=e.subjectId,a=e.emcOnSchoolId;return he().post("/poo/detach_emc",{subjectId:t,emcOnSchoolId:a})}},qa={computed:Object(u["a"])({},Object(r["b"])(["isSignin","user","activeSidebar","subjects","levels","publishers"])),created:function(){this.init(),this.activeSidebar=null},methods:{init:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Na.getUserData();case 3:a=t.sent,e.subjects=a.data.subjects,e.publishers=a.data.publishers,e.levels=a.data.levels,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.err=t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()}}},Ga=qa,Ha=Object(g["a"])(Ga,Ua,Ba,!1,null,"47a1f18a",null),Ja=Ha.exports;_()(Ha,{VCol:fe["a"],VRow:Oe["a"]});var Ka=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&3==e.user.UserRole.code?a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("h1",{staticClass:"text-center"},[e._v(e._s(e.subjectTitle))])])],1),a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"12"}},[e.activeRouteParams&&e.activeRouteParams.subjectId?a("EmcOnSchoolSelector"):e._e()],1),0===e.emcsOnSchool.length?a("v-card",{staticClass:"mx-auto text-center"},[e._v(" Отсутствуют УМК ")]):e._e(),a("v-col",{attrs:{cols:"12"}},e._l(e.emcsOnSchool,(function(t){return a("v-row",{key:t.id},[a("EmcOnSchoolCard",{attrs:{"emc-on-school":t},on:{onDetachEmcFrom:e.detachEmcFrom}})],1)})),1),a("v-col",{attrs:{cols:"12"}},[a("v-pagination",{attrs:{length:e.totalPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)],1)],1):e._e()},Qa=[],Wa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"px-0",attrs:{fluid:""}},[a("v-card",{attrs:{disabled:e.emcOnSchool.isApproved}},[a("v-card-title",{staticClass:"text-h4"},[e._v(" УМК: "+e._s(e.emcOnSchool.EMC.title))]),a("v-card-text",{staticClass:"text-h5"},[a("div",[a("v-chip",{directives:[{name:"show",rawName:"v-show",value:e.emcOnSchool.isApproved,expression:"emcOnSchool.isApproved"}],attrs:{color:"green","text-color":"white",pill:""}},[e._v(" Утверждено ")]),a("v-chip",{directives:[{name:"show",rawName:"v-show",value:!e.emcOnSchool.isApproved,expression:"!emcOnSchool.isApproved"}],attrs:{color:"yellow","text-color":"black",pill:""}},[e._v(" Не утверждено ")]),a("v-chip",{directives:[{name:"show",rawName:"v-show",value:e.emcOnSchool.EMC.isCustom&&e.emcOnSchool.EMC.createdBy===e.user.id,expression:"emcOnSchool.EMC.isCustom && emcOnSchool.EMC.createdBy === user.id"}],attrs:{color:"red","text-color":"white",pill:""}},[e._v(" Создано вами ")]),9==e.emcOnSchool.EMC.gia?a("v-chip",{attrs:{color:"indigo lighten-2","text-color":"white",pill:""}},[e._v(" ГИА-"+e._s(e.emcOnSchool.EMC.gia)+" ")]):e._e(),11==e.emcOnSchool.EMC.gia?a("v-chip",{attrs:{color:"light-blue accent-3","text-color":"white",pill:""}},[e._v(" ГИА-"+e._s(e.emcOnSchool.EMC.gia)+" ")]):e._e()],1),a("p",[a("strong",[e._v("Издательство:")]),e._v(" "+e._s(e.emcOnSchool.EMC.Publisher.publisherName))]),a("p",[a("strong",[e._v("Авторы:")]),e._v(" "+e._s(e.emcOnSchool.EMC.authors))]),a("p",[a("strong",[e._v("Класс:")]),e._v(" "+e._s(e.emcOnSchool.EMC.grades))]),a("p",[a("strong",[e._v("Кол-во учеников:")]),e._v(" "+e._s(e.emcOnSchool.studentsCount))]),a("p",[a("strong",[e._v("Уровень:")]),e._v(" "+e._s(e.emcOnSchool.EMC.Level?e.emcOnSchool.EMC.Level.name:"Нет данных")+" ")])]),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){e.isDetailing=!e.isDetailing}}},[e._v(" Комментарии ")]),e.emcOnSchool.EMC.isCustom&&e.emcOnSchool.EMC.createdBy===e.user.id?a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.goTo({name:"poo-emc-edit",params:{emcId:e.emcOnSchool.emcId,from:"poo-emc-on-school"}})}}},[e._v(" Редактировать ")]):e._e(),a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(t){return e.$emit("onDetachEmcFrom",e.emcOnSchool)}}},[e._v(" Открепить УМК ")])],1),a("v-expand-transition",[a("v-card",{directives:[{name:"show",rawName:"v-show",value:e.isDetailing,expression:"isDetailing"}]},[a("v-tabs",{attrs:{"background-color":"transparent",color:"basil",grow:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab",[e._v("Кол-во учеников")]),a("v-tab",[e._v("Причина использования")]),a("v-tab",[e._v("Причина изменения")]),a("v-tab",[e._v("Причина смены")])],1),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{"additional-eos-title":"Кол-во учеников","additional-eos-data-value":e.emcOnSchool.studentsCount,"is-number":!0},on:{"on-save-additional-data":e.saveStudentsCount}}),e._v(" "+e._s(e.emcOnSchool.studentsCount))],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{"additional-eos-title":"Причина использования","additional-eos-data-value":e.emcOnSchool.usingCoz},on:{"on-save-additional-data":e.saveUsingCozComment}}),e._v(" "+e._s(e.emcOnSchool.usingCoz)+" ")],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{"additional-eos-title":"Причина изменения","additional-eos-data-value":e.emcOnSchool.correctionCoz},on:{"on-save-additional-data":e.saveCorrectionCozComment}}),e._v(" "+e._s(e.emcOnSchool.correctionCoz))],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("TheEditAdditionalEOSData",{attrs:{"additional-eos-title":"Причина смены","additional-eos-data-value":e.emcOnSchool.swapCoz},on:{"on-save-additional-data":e.saveSwapCozComment}}),e._v(" "+e._s(e.emcOnSchool.swapCoz))],1)],1)],1)],1)],1)],1)],1)],1)},Xa=[],Ya={components:{TheEditAdditionalEOSData:at},props:{emcOnSchool:{type:Object,default:null}},data:function(){return{error:null,tab:null,isDetailing:!1}},computed:Object(u["a"])({},Object(r["b"])(["activeRouteParams","isSignin","user","emcs","emcsOnSchool"])),methods:{saveUsingCozComment:function(e){this.updateEmcOnSchool({usingCoz:e})},saveCorrectionCozComment:function(e){this.updateEmcOnSchool({correctionCoz:e})},saveSwapCozComment:function(e){this.updateEmcOnSchool({swapCoz:e})},saveStudentsCount:function(e){this.updateEmcOnSchool({studentsCount:e})},updateEmcOnSchool:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Na.updateEmcOnSchool(Object(u["a"])({emcId:t.emcOnSchool.id},e));case 3:t.activeRouteParams=Object(u["a"])({},t.activeRouteParams),a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),t.error=a.t0;case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()},goTo:function(e){var t=e.name,a=e.params;d.a.isEqual(this.activeRouteParams,a)||(this.activeRouteParams=Object(u["a"])(Object(u["a"])({},this.activeRouteParams),a),this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})))}}},Za=Ya,ec=(a("2f92"),Object(g["a"])(Za,Wa,Xa,!1,null,"5e4d8690",null)),tc=ec.exports;_()(ec,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VChip:nt["a"],VContainer:rt["a"],VExpandTransition:st["a"],VTab:it["a"],VTabItem:lt["a"],VTabs:ut["a"],VTabsItems:mt["a"]});var ac=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",{staticClass:"text-h5"},[e._v(" Добавить УМК ")]),a("v-card-text",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-autocomplete",{attrs:{items:e.emcsTitles,"no-data-text":"Нет данных","item-text":"Description","item-value":"emc",dense:"",rounded:"",solo:"","hide-selected":"",label:"УМК",placeholder:"Введите параметр УМК, по которому вы хотите найти нужный","prepend-icon":"mdi-database-search"},scopedSlots:e._u([{key:"item",fn:function(t){return[a("v-list-item-content",[a("v-list-item-title",[e._v(e._s(t.item.emc.previewData["Название"]))]),a("v-list-item-subtitle",[a("p",[e._v(" Авторы: "+e._s(t.item.emc.previewData["Авторы"])+"; Издатель: "+e._s(t.item.emc.previewData["Издатель"])+"; Классы: "+e._s(t.item.emc.previewData["Классы"])+" ")])])],1)]}}]),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1)],1),a("v-expand-transition",[e.model?a("v-list",[e._l(e.fields,(function(t,c){return a("v-list-item",{key:c},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:e._s(t.value)}}),a("v-list-item-subtitle",{domProps:{textContent:e._s(t.key)}})],1)],1)})),a("v-list-item",[a("v-text-field",{attrs:{type:"number",label:"Количество учеников"},model:{value:e.additionalDataForEmcOnSchool.studentsCount,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"studentsCount",t)},expression:"additionalDataForEmcOnSchool.studentsCount"}})],1),a("v-list-item",[a("v-text-field",{attrs:{label:"Причины использования"},model:{value:e.additionalDataForEmcOnSchool.usingCoz,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"usingCoz",t)},expression:"additionalDataForEmcOnSchool.usingCoz"}})],1),a("v-list-item",[a("v-text-field",{attrs:{label:"Причины смены"},model:{value:e.additionalDataForEmcOnSchool.swapCoz,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"swapCoz",t)},expression:"additionalDataForEmcOnSchool.swapCoz"}})],1),a("v-list-item",[a("v-text-field",{attrs:{label:"Планируемая корректировка"},model:{value:e.additionalDataForEmcOnSchool.correctionCoz,callback:function(t){e.$set(e.additionalDataForEmcOnSchool,"correctionCoz",t)},expression:"additionalDataForEmcOnSchool.correctionCoz"}})],1)],2):e._e()],1),a("v-card-actions",[a("v-btn",{attrs:{disabled:!e.model,color:"teal accent-3"},on:{click:e.attachEmc}},[e._v(" Добавить "),a("v-icon",{attrs:{right:""}},[e._v(" mdi-check ")])],1),a("v-spacer"),a("v-btn",{attrs:{disabled:!e.model,color:"red lighten-1"},on:{click:function(t){e.model=null}}},[e._v(" Закрыть "),a("v-icon",{attrs:{right:""}},[e._v(" mdi-close-circle ")])],1)],1)],1)},cc=[],oc={name:"EmcOnSchoolSelector",data:function(){return{model:null,search:null,isLoading:!1,additionalDataForEmcOnSchool:{swapCoz:null,usingCoz:null,correctionCoz:null,studentsCount:0},descriptionLimit:200,error:null}},computed:Object(u["a"])(Object(u["a"])({},Object(r["b"])(["emcs","emcsOnSchool","user","activeRouteParams"])),{},{routeParams:function(){return this.activeRouteParams},fields:function(){var e=this;return this.model?Object.keys(this.model.previewData).map((function(t){return{key:e.model.previewData[t],value:t}})):[]},emcsTitles:function(){var e=this;return this.emcs.reduce((function(t,a){var c;if(a&&a.Subject.id===(null===(c=e.activeRouteParams)||void 0===c?void 0:c.subjectId)&&0===e.emcsOnSchool.filter((function(t){return t.emcId===a.id&&t.School.id===e.user.schoolId})).length){var o=null==a.title?"Нет имени":a.title,n=null==a.authors?"Нет авторов":a.authors,r=o.concat(". ")+n.concat(". ")+a.Publisher.name,s=r.length>e.descriptionLimit?r.slice(0,e.descriptionLimit).concat("..."):r,i=[];i.previewData={},i.previewData["Название"]=o,i.previewData["Авторы"]=n,i.previewData["Издатель"]=a.Publisher.name,i.previewData["Предмет"]=a.Subject.name,i.previewData["Классы"]=a.grades,i.previewData["Уровень"]=a.Level.name,i.previewData["Создана вами"]=a.createdBy===e.user.id?"Да":"Нет",i.entry=a,t.push({Description:s,emc:i})}return t}),[])}}),watch:{routeParams:function(){this.model=null,this.getEmc()}},created:function(){this.getEmc()},methods:{getEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Na.getEmcToAttach(Object(u["a"])({},e.activeRouteParams));case 3:a=t.sent,e.emcs=a.data.emcs,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.error=t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},attachEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Na.attachTo(Object(u["a"])(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),e.additionalDataForEmcOnSchool),{},{emcId:e.model.entry.id}));case 3:e.activeRouteParams=Object(u["a"])({},e.activeRouteParams),e.model=null,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.error=t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}}},nc=oc,rc=Object(g["a"])(nc,ac,cc,!1,null,null,null),sc=rc.exports;_()(rc,{VAutocomplete:ft["a"],VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VCol:fe["a"],VExpandTransition:st["a"],VIcon:et["a"],VList:H["a"],VListItem:I["a"],VListItemContent:T["a"],VListItemSubtitle:T["b"],VListItemTitle:T["c"],VRow:Oe["a"],VSpacer:C["a"],VTextField:xe["a"]});var ic={components:{EmcOnSchoolCard:tc,EmcOnSchoolSelector:sc},data:function(){return{error:null,page:1,totalPages:1,limit:5}},computed:Object(u["a"])(Object(u["a"])({},Object(r["b"])(["activeRouteParams","activeSidebar","emcsOnSchool","isSignin","user","emcs","subjects"])),{},{subjectTitle:function(){var e,t,a=this;return null!==(e=null===(t=this.subjects.find((function(e){var t;return e.id===(null===(t=a.activeRouteParams)||void 0===t?void 0:t.subjectId)})))||void 0===t?void 0:t.name)&&void 0!==e?e:"Все предметы"},routeParams:function(){return this.activeRouteParams}}),watch:{routeParams:function(){this.getEmcOnSchool(),this.getEmc()},page:function(){this.getEmcOnSchool()}},created:function(){this.activeSidebar="poo",this.getEmcOnSchool(),this.getEmc()},methods:{getEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Na.getEmcToAttach(Object(u["a"])({},e.activeRouteParams));case 3:a=t.sent,console.log(Object(u["a"])({msg:"get_emcs_for_attach"},a.data)),e.emcs=a.data.emcs,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.error=t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},getEmcOnSchool:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Na.getEmcOnSchool(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),{},{skip:(e.page-1)*e.limit,limit:e.limit}));case 3:a=t.sent,console.log({msg:"get_emcs_on_school",totalEmcsOnSchool:a.data.totalEmcsOnSchool,emcsOnSchool:a.data.emcsOnSchool}),e.emcsOnSchool=a.data.emcsOnSchool,e.totalPages=Math.ceil(a.data.totalEmcsOnSchool/e.limit),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.error=t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},detachEmcFrom:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Na.detachFrom(Object(u["a"])(Object(u["a"])({},t.activeRouteParams),{},{emcOnSchoolId:e.id}));case 3:t.activeRouteParams=Object(u["a"])({},t.activeRouteParams),a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),t.error=a.t0;case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()}}},lc=ic,uc=Object(g["a"])(lc,Ka,Qa,!1,null,"a708995a",null),mc=uc.exports;_()(uc,{VCard:Xe["a"],VCol:fe["a"],VContainer:rt["a"],VPagination:Ct["a"],VRow:Oe["a"]});var dc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&3==e.user.UserRole.code?a("v-container",{staticClass:"px-0",attrs:{fluid:""}},[null==e.emc?a("v-card",[a("v-card-title",{staticClass:"text-h4 text-center"},[e._v(" Подождите...Данные либо грузятся, либо произошла ошибка. "),a("br"),e._v(" Попробуйте перезайти и попробовать снова ")])],1):e._e(),null!=e.emc?a("v-card",[a("v-card-title",{staticClass:"text-h4"},[e._v(" Редактирование УМК ")]),a("v-card-text",{staticClass:"text-h5"},[a("v-text-field",{attrs:{label:"Название"},model:{value:e.emc.title,callback:function(t){e.$set(e.emc,"title",t)},expression:"emc.title"}}),a("v-text-field",{attrs:{label:"Авторы"},model:{value:e.emc.authors,callback:function(t){e.$set(e.emc,"authors",t)},expression:"emc.authors"}}),a("v-text-field",{attrs:{label:"Класс"},model:{value:e.emc.grades,callback:function(t){e.$set(e.emc,"grades",t)},expression:"emc.grades"}}),a("v-select",{attrs:{items:e.subjects,"item-text":"name","no-data-text":"Нет данных",label:"Предмет","return-object":""},model:{value:e.emc.Subject,callback:function(t){e.$set(e.emc,"Subject",t)},expression:"emc.Subject"}}),a("v-select",{attrs:{items:e.levels,"item-text":"name","no-data-text":"Нет данных",label:"Уровень","return-object":""},model:{value:e.emc.Level,callback:function(t){e.$set(e.emc,"Level",t)},expression:"emc.Level"}}),a("v-select",{attrs:{items:e.publishers,"item-text":"name",label:"Издательство","no-data-text":"Нет данных","return-object":""},model:{value:e.emc.Publisher,callback:function(t){e.$set(e.emc,"Publisher",t)},expression:"emc.Publisher"}})],1),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:e.saveEmc}},[e._v(" Сохранить изменения ")]),a("v-spacer"),a("v-btn",{attrs:{text:"",color:"red accent-2"},on:{click:function(t){return e.goTo()}}},[e._v(" Отменить редактирование ")])],1)],1):e._e()],1):e._e()},vc=[],hc=["emcId","from"],pc={data:function(){return{loading:!1,error:null,message:null,emc:null}},computed:Object(u["a"])({},Object(r["b"])(["activeRouteParams","activeSidebar","isSignin","subjects","publishers","levels","user"])),created:function(){this.activeSidebar=null,this.getEmcForEdit()},methods:{getEmcForEdit:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Na.getEmc(Object(u["a"])({},e.activeRouteParams));case 3:a=t.sent,200===a.status?(c=Object(Pt["a"])(a.data.emcs,1),o=c[0],e.emc=o):e.goTo(),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.error=t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},saveEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Na.updateEmc(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),{},{emc:Object(u["a"])(Object(u["a"])({},e.emc),{},{publisherId:e.emc.Publisher.id,levelId:e.emc.Level.id,subjectId:e.emc.Subject.id})}));case 3:e.goTo(),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),e.error=t.t0;case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},goTo:function(){var e=this.activeRouteParams,t=(e.emcId,e.from),a=Object(Rt["a"])(e,hc);this.activeRouteParams=Object(u["a"])({},a),this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)}))}}},bc=pc,gc=Object(g["a"])(bc,dc,vc,!1,null,null,null),fc=gc.exports;_()(gc,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VContainer:rt["a"],VSelect:zt["a"],VSpacer:C["a"],VTextField:xe["a"]});var _c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&3==e.user.UserRole.code?a("v-container",{staticClass:"px-0",attrs:{fluid:""}},[a("v-card",[a("v-card-title",{staticClass:"text-h4"},[e._v(" Создание УМК ")]),a("v-card-text",{staticClass:"text-h5"},[a("v-text-field",{attrs:{label:"Название",placeholder:"Введите название умк"},model:{value:e.emc.title,callback:function(t){e.$set(e.emc,"title",t)},expression:"emc.title"}}),a("v-text-field",{attrs:{label:"Авторы",placeholder:"Введите автора умк"},model:{value:e.emc.authors,callback:function(t){e.$set(e.emc,"authors",t)},expression:"emc.authors"}}),a("v-text-field",{attrs:{label:"Класс",placeholder:"Введите классы умк"},model:{value:e.emc.grades,callback:function(t){e.$set(e.emc,"grades",t)},expression:"emc.grades"}}),a("v-select",{attrs:{items:e.levels,"item-text":"name","no-data-text":"Нет данных",label:"Уровень",solo:"","return-object":""},model:{value:e.emc.Level,callback:function(t){e.$set(e.emc,"Level",t)},expression:"emc.Level"}}),a("v-select",{attrs:{items:e.publishers,"item-text":"name","no-data-text":"Нет данных",label:"Издательство",placeholder:"Выберите издательство умк",solo:"","return-object":""},model:{value:e.emc.Publisher,callback:function(t){e.$set(e.emc,"Publisher",t)},expression:"emc.Publisher"}}),a("v-select",{attrs:{items:e.subjects,"item-text":"name","no-data-text":"Нет данных",label:"Предмет",placeholder:"Выберите предмет умк",solo:"","return-object":""},model:{value:e.emc.Subject,callback:function(t){e.$set(e.emc,"Subject",t)},expression:"emc.Subject"}})],1),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:e.createEmc}},[e._v(" Создать УМК ")]),a("v-btn",{attrs:{text:"",color:"red accent-2",to:{name:"poo-emc"}}},[e._v(" Назад ")])],1)],1)],1):e._e()},Oc=[],xc={data:function(){return{error:null,message:null,emc:{title:null,grades:null,authors:null,levelId:null,Level:null,subjectId:null,Subject:null,publisherId:null,Publisher:null,isCustom:!1}}},computed:Object(u["a"])({},Object(r["b"])(["activeRouteParams","isSignin","user","publishers","subjects","levels"])),created:function(){this.activeSidebar=null},methods:{createEmc:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,null!=e.emc.title&&null!=e.emc.authors&&null!=e.emc.grades&&null!=e.emc.Publisher&&null!=e.emc.Subject&&null!=e.emc.Level){t.next=3;break}throw Error("Один из параметров не указан");case 3:return console.log("creating emc ",e.emc),t.next=6,Na.createEmc({emc:e.emc});case 6:e.activeRouteParams={subjectId:e.emc.Subject.id},e.$router.push({name:"poo-emc"}),t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),e.error=t.t0,console.error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()}}},Sc=xc,Cc=Object(g["a"])(Sc,_c,Oc,!1,null,null,null),jc=Cc.exports;_()(Cc,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VContainer:rt["a"],VSelect:zt["a"],VTextField:xe["a"]});var Ec=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isSignin&&3==e.user.UserRole.code?a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"12"}},[a("h1",{staticClass:"text-center"},[e._v(e._s(e.subjectTitle))])]),a("v-col",{attrs:{cols:"12"}},[a("v-btn",{attrs:{text:"",color:"teal accent-4",to:{name:"poo-emc-create"}}},[e._v(" Создать УМК ")])],1),a("v-col",{attrs:{cols:"12"}},[0===e.emcs.length?a("v-card",{staticClass:"mx-auto text-center"},[e._v(" Учебников по этому предмету созданных вами нету ")]):e._e()],1),a("v-col",{attrs:{cols:"12"}},e._l(e.emcs,(function(t){return a("v-card",{key:t.id},[a("v-card-title",{staticClass:"text-h4"},[e._v(" "+e._s(t.title))]),a("v-card-text",{staticClass:"text-h5"},[a("div",[a("v-chip",{directives:[{name:"show",rawName:"v-show",value:t.isCustom&&t.createdBy===e.user.id,expression:"emc.isCustom && emc.createdBy === user.id"}],attrs:{color:"red","text-color":"white",pill:""}},[e._v(" Созданный вами ")])],1),a("p",[a("strong",[e._v(" Издательство: ")]),e._v(" "+e._s(t.Publisher.name))]),a("p",[a("strong",[e._v(" Авторы: ")]),e._v(" "+e._s(t.authors))]),a("p",[a("strong",[e._v(" Класс:")]),e._v(" "+e._s(t.grades))]),a("p",[a("strong",[e._v(" Уровень:")]),e._v(" "+e._s(t.Level?t.Level.name:"Нет данных"))]),9==t.gia?a("v-chip",{attrs:{color:"indigo lighten-2","text-color":"white",pill:""}},[e._v(" ГИА-"+e._s(t.gia)+" ")]):e._e(),11==t.gia?a("v-chip",{attrs:{color:"light-blue accent-3","text-color":"white",pill:""}},[e._v(" ГИА-"+e._s(t.gia)+" ")]):e._e(),a("v-chip",{attrs:{color:"light-blue accent-3","text-color":"white",pill:""}},[e._v(" "+e._s(t.Subject.name)+" ")])],1),a("v-card-actions",[t.isCustom&&t.createdBy===e.user.id?a("v-btn",{attrs:{text:"",color:"teal accent-4"},on:{click:function(a){return e.goTo({name:"poo-emc-edit",params:{emcId:t.id,from:"poo-emc"}})}}},[e._v(" Редактировать ")]):e._e(),a("v-spacer"),t.isCustom&&t.createdBy===e.user.id?a("v-btn",{attrs:{text:"",color:"red darken-1"},on:{click:function(a){return e.deleteEmc({emc:t})}}},[e._v(" Удалить ")]):e._e()],1)],1)})),1),a("v-col",{attrs:{cols:"12"}},[a("v-pagination",{attrs:{length:e.totalPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)],1):e._e()},wc=[],kc=["emcId"],Rc={data:function(){return{error:null,page:1,totalPages:1,limit:5}},computed:Object(u["a"])(Object(u["a"])({},Object(r["b"])(["subjects","isSignin","user","emcs","activeRouteParams","activeSidebar"])),{},{routeParams:function(){return this.activeRouteParams},subjectTitle:function(){var e,t,a=this;return null!==(e=null===(t=this.subjects.find((function(e){var t;return e.id===(null===(t=a.activeRouteParams)||void 0===t?void 0:t.subjectId)})))||void 0===t?void 0:t.name)&&void 0!==e?e:"Все предметы"}}),watch:{routeParams:function(){this.getEmcForConstructor()},page:function(){this.getEmcForConstructor()}},created:function(){this.activeSidebar="subjects",this.getEmcForConstructor()},methods:{getEmcForConstructor:function(){var e=this;return Object(me["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log("this.activeRouteParams: ",e.activeRouteParams),t.next=4,Na.getEmc(Object(u["a"])(Object(u["a"])({},e.activeRouteParams),{},{skip:(e.page-1)*e.limit,limit:e.limit}));case 4:a=t.sent,console.log({msg:"response: ",emcs:a.data.emcs,totalEmcs:a.data.totalEmcs}),e.emcs=a.data.emcs,e.totalPages=Math.ceil(a.data.totalEmcs/e.limit),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.error=t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},deleteEmc:function(e){var t=this;return Object(me["a"])(regeneratorRuntime.mark((function a(){var c,o,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return c=e.emc,a.prev=1,a.next=4,Na.deleteEmc({emcId:c.id});case 4:o=t.activeRouteParams,o.emcId,n=Object(Rt["a"])(o,kc),t.activeRouteParams=Object(u["a"])({},n),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](1),t.error=a.t0;case 11:case"end":return a.stop()}}),a,null,[[1,8]])})))()},goTo:function(e){var t=e.name,a=e.params;d.a.isEqual(this.activeRouteParams,a)||(this.activeRouteParams=Object(u["a"])(Object(u["a"])({},this.activeRouteParams),a),this.$router.push({name:t}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})))}}},Pc=Rc,Vc=Object(g["a"])(Pc,Ec,wc,!1,null,null,null),Ic=Vc.exports;_()(Vc,{VBtn:x["a"],VCard:Xe["a"],VCardActions:Ye["a"],VCardText:Ye["b"],VCardTitle:Ye["c"],VChip:nt["a"],VCol:fe["a"],VPagination:Ct["a"],VRow:Oe["a"],VSpacer:C["a"]}),c["a"].use(ie["a"]);var Tc=function(e,t,a){s.state.isSignin&&1===s.state.user.UserRole.code?a():a("/")},Dc=function(e,t,a){s.state.isSignin&&2===s.state.user.UserRole.code?a():a("/")},zc=function(e,t,a){console.log("Signed poo: ",s.state.isSignin&&3===s.state.user.UserRole.code),s.state.isSignin&&3===s.state.user.UserRole.code?a():a("/")},Ac=new ie["a"]({mode:"history",routes:[{path:"/",name:"/",component:Pe},{path:"/signup",name:"signup",component:Ce},{path:"/admin",name:"main-admin",component:Be,beforeEnter:Tc},{name:"admin-emc-on-school",path:"/admin/list_emc_on_school",component:Et,beforeEnter:Tc},{name:"admin-emc",path:"/admin/list_emc",component:Qt,beforeEnter:Tc},{name:"admin-emc-create",path:"/admin/create_emc",component:Bt,beforeEnter:Tc},{name:"admin-emc-edit",path:"/admin/update_emc",component:$t,beforeEnter:Tc},{path:"/pmo",name:"main-pmo",component:aa,beforeEnter:Dc},{name:"pmo-emc-on-school",path:"/pmo/list_emc_on_school",component:Oa,beforeEnter:Dc},{name:"pmo-emc",path:"/pmo/list_emc",component:Ma,beforeEnter:Dc},{name:"pmo-emc-create",path:"/pmo/create_emc",component:Da,beforeEnter:Dc},{name:"pmo-emc-edit",path:"/pmo/update_emc",component:ka,beforeEnter:Dc},{path:"/poo",name:"main-poo",component:Ja,beforeEnter:zc},{name:"poo-emc-on-school",path:"/poo/list_emc_on_school",component:mc,beforeEnter:zc},{name:"poo-emc",path:"/poo/emc",component:Ic,beforeEnter:zc},{name:"poo-emc-create",path:"/poo/create_emc",component:jc,beforeEnter:zc},{name:"poo-emc-edit",path:"/poo/update_emc",component:fc,beforeEnter:zc},{path:"*",component:Ae}]}),$c=a("f309");a("5363");c["a"].use($c["a"]);var yc=new $c["a"]({});c["a"].config.productionTip=!1,Object(o["sync"])(s,Ac),new c["a"]({store:s,router:Ac,vuetify:yc,render:function(e){return e(se)}}).$mount("#app")},"61b5":function(e,t,a){"use strict";a("fea6")},"673d":function(e,t,a){},"742a":function(e,t,a){},cf05:function(e,t,a){e.exports=a.p+"img/logo.18cb333b.png"},e627:function(e,t,a){"use strict";a("742a")},fea6:function(e,t,a){}});
//# sourceMappingURL=app.4b73d167.js.map